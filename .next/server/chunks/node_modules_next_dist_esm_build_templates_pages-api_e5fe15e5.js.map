{"version":3,"sources":["turbopack:///[project]/src/pages/api/a3s/[series]/versions/index.js","turbopack:///[project]/node_modules/next/dist/esm/build/templates/pages-api.js","turbopack:///[project]/src/utils/Utils.js"],"sourcesContent":["import fs from 'fs';\r\nimport path from 'path';\r\nimport { toInitialLast } from '@/utils/Utils';\r\n\r\nfunction formatDateForLog(d) {\r\n    if (!d) return 'N/A';\r\n    try {\r\n        const dt = new Date(d);\r\n        if (isNaN(dt)) return String(d);\r\n        const pad = n => String(n).padStart(2, '0');\r\n        const dd = pad(dt.getUTCDate());\r\n        const mm = pad(dt.getUTCMonth() + 1);\r\n        const yyyy = dt.getUTCFullYear();\r\n        const hh = pad(dt.getUTCHours());\r\n        const min = pad(dt.getUTCMinutes());\r\n        // if time portion is midnight UTC, show only date\r\n        if (dt.getUTCHours() === 0 && dt.getUTCMinutes() === 0 && dt.getUTCSeconds() === 0) {\r\n            return `${dd}-${mm}-${yyyy}`;\r\n        }\r\n        return `${dd}-${mm}-${yyyy} ${hh}:${min}`;\r\n    } catch (e) { return String(d); }\r\n}\r\n\r\nfunction arraysEqual(a, b) {\r\n    const A = Array.isArray(a) ? a : (a ? [a] : []);\r\n    const B = Array.isArray(b) ? b : (b ? [b] : []);\r\n    if (A.length !== B.length) return false;\r\n    const norm = arr => arr.map(x => (typeof x === 'object' ? JSON.stringify(x) : String(x))).sort();\r\n    const sa = norm(A);\r\n    const sb = norm(B);\r\n    for (let i = 0; i < sa.length; i++) if (sa[i] !== sb[i]) return false;\r\n    return true;\r\n}\r\n\r\nfunction nextVersionLabel(label) {\r\n    if (!label) return 'A';\r\n    const base = 26;\r\n    const letters = label.toUpperCase().split('');\r\n    let digits = letters.map(ch => ch.charCodeAt(0) - 65);\r\n    for (let i = digits.length - 1; i >= 0; i--) {\r\n        digits[i] += 1;\r\n        if (digits[i] < base) {\r\n            return digits.map(d => String.fromCharCode(65 + d)).join('');\r\n        }\r\n        digits[i] = 0;\r\n        if (i === 0) {\r\n            digits = [0].concat(digits);\r\n            return digits.map(d => String.fromCharCode(65 + d)).join('');\r\n        }\r\n    }\r\n    return 'A';\r\n}\r\n\r\nfunction labelToNumber(label) {\r\n    if (!label) return 0;\r\n    const letters = label.toUpperCase().split('');\r\n    let value = 0;\r\n    for (let i = 0; i < letters.length; i++) {\r\n        value = value * 26 + (letters[i].charCodeAt(0) - 64);\r\n    }\r\n    return value;\r\n}\r\n\r\nfunction getChangeLog(current, previous) {\r\n    // produce a structured changelog map: keys -> array of phrase strings\r\n    // Keep a short string `message` for backward compatibility\r\n    if (!previous) return { changelog: { 'General': ['Initial snapshot.'] } };\r\n    try {\r\n        const sections = ['General', 'Problem Definition', 'Metrics & Objectives', 'Actions', 'Current State', 'Future State'];\r\n        let changelog = {};\r\n\r\n        for (const h of sections) {\r\n            if (h === 'General') {\r\n                if (current.header.title !== previous.header.title) {\r\n                    changelog['General'] = changelog['General'] || [];\r\n                    changelog['General'].push(`Title changed from \"${previous.header.title || 'Untitled'}\" to \"${current.header.title || 'Untitled'}\".`);\r\n                }\r\n                if (current.header.team !== previous.header.team) {\r\n                    // calculate diff in team members\r\n                    const currentTeam = Array.isArray(current.header.team) ? current.header.team : [];\r\n                    const previousTeam = Array.isArray(previous.header.team) ? previous.header.team : [];\r\n                    const normalize = m => {\r\n                        if (m == null) return '';\r\n                        if (typeof m === 'object') return m.id || m.name || JSON.stringify(m);\r\n                        return String(m);\r\n                    };\r\n\r\n                    const curNorm = currentTeam.map(normalize);\r\n                    const prevNorm = previousTeam.map(normalize);\r\n\r\n                    const added = curNorm.filter(x => !prevNorm.includes(x)).map(x => toInitialLast(x));\r\n                    const removed = prevNorm.filter(x => !curNorm.includes(x)).map(x => toInitialLast(x));\r\n\r\n                    if (added.length) {\r\n                        changelog['General'] = changelog['General'] || [];\r\n                        changelog['General'].push(`Team members added: ${added.join(', ')}.`);\r\n                    }\r\n                    if (removed.length) {\r\n                        changelog['General'] = changelog['General'] || [];\r\n                        changelog['General'].push(`Team members removed: ${removed.join(', ')}.`);\r\n                    }\r\n                }\r\n                if ((current.header.start !== previous.header.start) || (current.header.end !== previous.header.end)) {\r\n                    changelog['General'] = changelog['General'] || [];\r\n                    changelog['General'].push(`Project timeline changed from ${formatDateForLog(previous.header.start)} - ${formatDateForLog(previous.header.end)} to ${formatDateForLog(current.header.start)} - ${formatDateForLog(current.header.end)}.`);\r\n                }\r\n                if ((current.header.refs || []).sort().join(',') !== (previous.header.refs || []).sort().join(',')) {\r\n                    changelog['General'] = changelog['General'] || [];\r\n                    changelog['General'].push(`External A3 references changed.`);\r\n                }\r\n                if ((current.header.attachments || []).sort().join(',') !== (previous.header.attachments || []).sort().join(',')) {\r\n                    changelog['General'] = changelog['General'] || [];\r\n                    changelog['General'].push(`File attachments changed.`);\r\n                }\r\n                if (JSON.stringify(current.layout.sections) !== JSON.stringify(previous.layout.sections)) {\r\n                    changelog['General'] = changelog['General'] || [];\r\n                    changelog['General'].push(`Layout changed.`);\r\n                }\r\n                if (!arraysEqual(current.layout.canEdit, previous.layout.canEdit)) {\r\n                    changelog['General'] = changelog['General'] || [];\r\n                    changelog['General'].push(`(OWNER) Layout edit permissions changed.`);\r\n                }\r\n            } else if (h === 'Problem Definition') {\r\n                if (current.probDef.why !== previous.probDef.why) {\r\n                    changelog['Problem Definition'] = changelog['Problem Definition'] || [];\r\n                    changelog['Problem Definition'].push(`\"Why\" statement updated.`);\r\n                }\r\n                if (current.probDef.where !== previous.probDef.where) {\r\n                    changelog['Problem Definition'] = changelog['Problem Definition'] || [];\r\n                    changelog['Problem Definition'].push(`\"Where\" statement updated.`);\r\n                }\r\n                if (current.probDef.extra !== previous.probDef.extra) {\r\n                    changelog['Problem Definition'] = changelog['Problem Definition'] || [];\r\n                    changelog['Problem Definition'].push(`Additional problem details updated.`);\r\n                }\r\n                if (JSON.stringify(current.metrics.lag.placeholder) !== JSON.stringify(previous.metrics.lag.placeholder)) {\r\n                    changelog['Problem Definition'] = changelog['Problem Definition'] || [];\r\n                    changelog['Problem Definition'].push(`Problem placeholder updated.`);\r\n                }\r\n                if (!arraysEqual(current.probDef.canEdit, previous.probDef.canEdit)) {\r\n                    changelog['Problem Definition'] = changelog['Problem Definition'] || [];\r\n                    changelog['Problem Definition'].push(`(OWNER) Problem Definition edit permissions changed.`);\r\n                }\r\n            } else if (h === 'Current State') {\r\n                if (JSON.stringify(current.currentState) !== JSON.stringify(previous.currentState)) {\r\n                    changelog['Current State'] = changelog['Current State'] || [];\r\n                    changelog['Current State'].push(`Current State canvas updated.`);\r\n                }\r\n                if (current.layout.extraCurrentState.enabled !== previous.layout.extraCurrentState.enabled) {\r\n                    changelog['Current State'] = changelog['Current State'] || [];\r\n                    changelog['Current State'].push(`Current State comment section ${current.layout.extraCurrentState.enabled ? 'enabled' : 'disabled'}.`);\r\n                }\r\n                if (JSON.stringify(current.layout.extraCurrentState.text) !== JSON.stringify(previous.layout.extraCurrentState.text)) {\r\n                    changelog['Current State'] = changelog['Current State'] || [];\r\n                    changelog['Current State'].push(`Current State comments updated.`);\r\n                }\r\n                if (!arraysEqual(current.currentState.canEdit, previous.currentState.canEdit)) {\r\n                    changelog['Current State'] = changelog['Current State'] || [];\r\n                    changelog['Current State'].push(`(OWNER) Current State edit permissions changed.`);\r\n                }\r\n            } else if (h === 'Future State') {\r\n                if (current.layout.includeFutureState !== previous.layout.includeFutureState) {\r\n                    changelog['Future State'] = changelog['Future State'] || [];\r\n                    changelog['Future State'].push(`Section ${current.layout.includeFutureState ? 'enabled' : 'disabled'}.`);\r\n                }\r\n                if (JSON.stringify(current.actionPlan) !== JSON.stringify(previous.actionPlan)) {\r\n                    changelog['Future State'] = changelog['Future State'] || [];\r\n                    changelog['Future State'].push(`Future State canvas updated.`);\r\n                }\r\n                if (!arraysEqual(current.actionPlan.canEdit, previous.actionPlan.canEdit)) {\r\n                    changelog['Future State'] = changelog['Future State'] || [];\r\n                    changelog['Future State'].push(`(OWNER) Future State edit permissions changed.`);\r\n                }\r\n            } else if (h === 'Actions') {\r\n                const curActions = Array.isArray(current.actions) ? current.actions : [];\r\n                const prevActions = Array.isArray(previous.actions) ? previous.actions : [];\r\n\r\n                const curById = new Map(curActions.map(a => [String(a.id), a]));\r\n                const prevById = new Map(prevActions.map(a => [String(a.id), a]));\r\n\r\n                const added = curActions.filter(a => !prevById.has(String(a.id)));\r\n                const removed = prevActions.filter(a => !curById.has(String(a.id)));\r\n\r\n                if (added.length) {\r\n                    changelog['Actions'] = changelog['Actions'] || [];\r\n                    changelog['Actions'].push(`Added actions: ${added.map(a => `#${a.id} ${a.description || ''}`.trim()).join(', ')}.`);\r\n                }\r\n                if (removed.length) {\r\n                    changelog['Actions'] = changelog['Actions'] || [];\r\n                    changelog['Actions'].push(`Removed actions: ${removed.map(a => `#${a.id} ${a.description || ''}`.trim()).join(', ')}.`);\r\n                }\r\n\r\n                // per-action changes for existing actions\r\n                const commonIds = Array.from(curById.keys()).filter(id => prevById.has(id));\r\n                for (const id of commonIds) {\r\n                    const cur = curById.get(id);\r\n                    const prev = prevById.get(id);\r\n                    const diffs = [];\r\n                    // progress change\r\n                    if ((typeof cur.progress !== 'undefined' || typeof prev.progress !== 'undefined') && cur.progress !== prev.progress) {\r\n                        const fmt = v => (v === null || typeof v === 'undefined' ? '—' : (Number(v) <= 1 ? `${Math.round(Number(v) * 100)}%` : `${Math.round(Number(v))}%`));\r\n                        diffs.push(`progress ${fmt(prev.progress)} → ${fmt(cur.progress)}`);\r\n                    }\r\n                    // owner change\r\n                    if ((cur.owner || '') !== (prev.owner || '')) {\r\n                        const oldOwner = prev.owner ? toInitialLast(prev.owner) : '—';\r\n                        const newOwner = cur.owner ? toInitialLast(cur.owner) : '—';\r\n                        diffs.push(`owner ${oldOwner} → ${newOwner}`);\r\n                    }\r\n                    // limit change\r\n                    if ((cur.limit || '') !== (prev.limit || '')) {\r\n                        const oldLimit = prev.limit || '—';\r\n                        const newLimit = cur.limit || '—';\r\n                        diffs.push(`limit ${oldLimit} → ${newLimit}`);\r\n                    }\r\n                    // weight change\r\n                    if ((cur.weight || '') !== (prev.weight || '')) {\r\n                        const oldW = prev.weight || '—';\r\n                        const newW = cur.weight || '—';\r\n                        diffs.push(`weight ${oldW} → ${newW}`);\r\n                    }\r\n\r\n                    if (diffs.length) {\r\n                        changelog['Actions'] = changelog['Actions'] || [];\r\n                        changelog['Actions'].push(`Action #${id} (${cur.description || ''}): ${diffs.join('; ')}.`);\r\n                    }\r\n                }\r\n\r\n                // actionsSettings.weighted changed?\r\n                try {\r\n                    const curWeighted = current.actionsSettings && typeof current.actionsSettings.weighted !== 'undefined' ? Boolean(current.actionsSettings.weighted) : null;\r\n                    const prevWeighted = previous.actionsSettings && typeof previous.actionsSettings.weighted !== 'undefined' ? Boolean(previous.actionsSettings.weighted) : null;\r\n                    if (curWeighted !== null && prevWeighted !== null && curWeighted !== prevWeighted) {\r\n                        changelog['Actions'] = changelog['Actions'] || [];\r\n                        changelog['Actions'].push(`Weighting ${curWeighted ? 'enabled' : 'disabled'}.`);\r\n                    }\r\n                } catch (e) { /* ignore */ }\r\n\r\n            } else if (h === 'Metrics & Objectives') {\r\n                const curMetrics = current.metrics || {};\r\n                const prevMetrics = previous.metrics || {};\r\n\r\n                // handle primary lag metric\r\n                const curLag = curMetrics.lag || {};\r\n                const prevLag = prevMetrics.lag || {};\r\n                const lagName = curLag.metricName || prevLag.metricName || 'lag';\r\n\r\n                if ((curLag.metricName || '') !== (prevLag.metricName || '')) {\r\n                    changelog['Metrics & Objectives'] = changelog['Metrics & Objectives'] || [];\r\n                    changelog['Metrics & Objectives'].push(`Metric name changed: \"${prevLag.metricName || '—'}\" → \"${curLag.metricName || '—'}\".`);\r\n                }\r\n                if ((curLag.unit || '') !== (prevLag.unit || '')) {\r\n                    changelog['Metrics & Objectives'] = changelog['Metrics & Objectives'] || [];\r\n                    changelog['Metrics & Objectives'].push(`Metric ${lagName} unit changed: \"${prevLag.unit || '—'}\" → \"${curLag.unit || '—'}\".`);\r\n                }\r\n                if (typeof curLag.initial !== 'undefined' || typeof prevLag.initial !== 'undefined') {\r\n                    if (String(curLag.initial || '') !== String(prevLag.initial || '')) {\r\n                        changelog['Metrics & Objectives'] = changelog['Metrics & Objectives'] || [];\r\n                        changelog['Metrics & Objectives'].push(`Metric ${lagName} initial value changed: \"${prevLag.initial || '—'}\" → \"${curLag.initial || '—'}\".`);\r\n                    }\r\n                }\r\n                // target comparison (value/mode/percent)\r\n                const curT = curLag.target || {};\r\n                const prevT = prevLag.target || {};\r\n                const targetDiffs = [];\r\n                if (typeof curT.value !== 'undefined' || typeof prevT.value !== 'undefined') {\r\n                    if (String(curT.value || '') !== String(prevT.value || '')) targetDiffs.push(`value ${prevT.value || '—'} → ${curT.value || '—'}`);\r\n                }\r\n                if (typeof curT.mode !== 'undefined' || typeof prevT.mode !== 'undefined') {\r\n                    if ((curT.mode || '') !== (prevT.mode || '')) targetDiffs.push(`mode ${prevT.mode || '—'} → ${curT.mode || '—'}`);\r\n                }\r\n                if (typeof curT.percent !== 'undefined' || typeof prevT.percent !== 'undefined') {\r\n                    if (String(curT.percent || '') !== String(prevT.percent || '')) targetDiffs.push(`percent ${prevT.percent || '—'} → ${curT.percent || '—'}`);\r\n                }\r\n                if (targetDiffs.length) {\r\n                    changelog['Metrics & Objectives'] = changelog['Metrics & Objectives'] || [];\r\n                    changelog['Metrics & Objectives'].push(`Metric ${lagName} target changed: ${targetDiffs.join('; ')}.`);\r\n                }\r\n                // data changed -> generic note only\r\n                try {\r\n                    const curData = Array.isArray(curLag.data) ? curLag.data : [];\r\n                    const prevData = Array.isArray(prevLag.data) ? prevLag.data : [];\r\n                    if (JSON.stringify(curData) !== JSON.stringify(prevData)) {\r\n                        changelog['Metrics & Objectives'] = changelog['Metrics & Objectives'] || [];\r\n                        changelog['Metrics & Objectives'].push(`Metric ${lagName} data updated.`);\r\n                    }\r\n                } catch (e) { /* ignore */ }\r\n\r\n                // handles lead metrics (array)\r\n                const curLeads = Array.isArray(curMetrics.leads) ? curMetrics.leads : [];\r\n                const prevLeads = Array.isArray(prevMetrics.leads) ? prevMetrics.leads : [];\r\n                const prevByName = new Map(prevLeads.map(m => [m.metricName || String(Math.random()), m]));\r\n                const curByName = new Map(curLeads.map(m => [m.metricName || String(Math.random()), m]));\r\n\r\n                const addedLeads = curLeads.filter(m => !(prevByName.has(m.metricName)));\r\n                const removedLeads = prevLeads.filter(m => !(curByName.has(m.metricName)));\r\n\r\n                if (addedLeads.length) {\r\n                    changelog['Metrics & Objectives'] = changelog['Metrics & Objectives'] || [];\r\n                    changelog['Metrics & Objectives'].push(`Added metrics: ${addedLeads.map(m => `${m.metricName || 'unnamed'}`).join(', ')}.`);\r\n                }\r\n                if (removedLeads.length) {\r\n                    changelog['Metrics & Objectives'] = changelog['Metrics & Objectives'] || [];\r\n                    changelog['Metrics & Objectives'].push(`Removed metrics: ${removedLeads.map(m => `${m.metricName || 'unnamed'}`).join(', ')}.`);\r\n                }\r\n\r\n                // compare existing leads\r\n                for (const [name, curM] of curByName.entries()) {\r\n                    if (!prevByName.has(name)) continue;\r\n                    const prevM = prevByName.get(name);\r\n                    const diffs = [];\r\n                    if ((curM.unit || '') !== (prevM.unit || '')) diffs.push(`unit ${prevM.unit || '—'} → ${curM.unit || '—'}`);\r\n                    if (String(curM.initial || '') !== String(prevM.initial || '')) diffs.push(`initial ${prevM.initial || '—'} → ${curM.initial || '—'}`);\r\n                    const curMt = curM.target || {};\r\n                    const prevMt = prevM.target || {};\r\n                    if (String(curMt.value || '') !== String(prevMt.value || '')) diffs.push(`target value ${prevMt.value || '—'} → ${curMt.value || '—'}`);\r\n                    if ((curMt.mode || '') !== (prevMt.mode || '')) diffs.push(`target mode ${prevMt.mode || '—'} → ${curMt.mode || '—'}`);\r\n                    if (diffs.length) {\r\n                        changelog['Metrics & Objectives'] = changelog['Metrics & Objectives'] || [];\r\n                        changelog['Metrics & Objectives'].push(`Metric ${name}: ${diffs.join('; ')}.`);\r\n                    }\r\n                    // data change => generic\r\n                    try {\r\n                        const curData = Array.isArray(curM.data) ? curM.data : [];\r\n                        const prevData = Array.isArray(prevM.data) ? prevM.data : [];\r\n                        if (JSON.stringify(curData) !== JSON.stringify(prevData)) {\r\n                            changelog['Metrics & Objectives'] = changelog['Metrics & Objectives'] || [];\r\n                            changelog['Metrics & Objectives'].push(`Metric ${name} data updated.`);\r\n                        }\r\n                    } catch (e) { /* ignore */ }\r\n                }\r\n                // permissions: canEditObjectives / canEditMetrics\r\n                try {\r\n                    const curCanEditObj = Array.isArray(curMetrics.canEditObjectives) ? curMetrics.canEditObjectives : (curMetrics.canEditObjectives || []);\r\n                    const prevCanEditObj = Array.isArray(prevMetrics.canEditObjectives) ? prevMetrics.canEditObjectives : (prevMetrics.canEditObjectives || []);\r\n                    if (JSON.stringify(curCanEditObj) !== JSON.stringify(prevCanEditObj)) {\r\n                        changelog['Metrics & Objectives'] = changelog['Metrics & Objectives'] || [];\r\n                        changelog['Metrics & Objectives'].push(`(OWNER) Objectives edit permissions changed.`);\r\n                    }\r\n\r\n                    const curCanEditMet = Array.isArray(curMetrics.canEditMetrics) ? curMetrics.canEditMetrics : (curMetrics.canEditMetrics || []);\r\n                    const prevCanEditMet = Array.isArray(prevMetrics.canEditMetrics) ? prevMetrics.canEditMetrics : (prevMetrics.canEditMetrics || []);\r\n                    if (JSON.stringify(curCanEditMet) !== JSON.stringify(prevCanEditMet)) {\r\n                        changelog['Metrics & Objectives'] = changelog['Metrics & Objectives'] || [];\r\n                        changelog['Metrics & Objectives'].push(`(OWNER) Check Act edit permissions changed.`);\r\n                    }\r\n                } catch (e) { /* ignore */ }\r\n                // also mirror Check/Act changes into Metrics (if present)\r\n                try {\r\n                    if (current.layout && previous.layout && current.layout.extraCheckAct && previous.layout.extraCheckAct) {\r\n                        if (current.layout.extraCheckAct.enabled !== previous.layout.extraCheckAct.enabled) {\r\n                            changelog['Metrics & Objectives'] = changelog['Metrics & Objectives'] || [];\r\n                            changelog['Metrics & Objectives'].push(`Check/Act comment section ${current.layout.extraCheckAct.enabled ? 'enabled' : 'disabled'}.`);\r\n                        }\r\n                        if (JSON.stringify(current.layout.extraCheckAct.text) !== JSON.stringify(previous.layout.extraCheckAct.text)) {\r\n                            changelog['Metrics & Objectives'] = changelog['Metrics & Objectives'] || [];\r\n                            changelog['Metrics & Objectives'].push(`Check/Act comments updated.`);\r\n                        }\r\n                        if (!arraysEqual(current.layout.extraCheckAct.canEdit, previous.layout.extraCheckAct.canEdit)) {\r\n                            changelog['Metrics & Objectives'] = changelog['Metrics & Objectives'] || [];\r\n                            changelog['Metrics & Objectives'].push(`(OWNER) Check/Act edit permissions changed.`);\r\n                        }\r\n                    }\r\n                } catch (e) { /* ignore */ }\r\n                // Mirror Check/Act messages under Objectives as well\r\n                try {\r\n                    if (current.layout && previous.layout && current.layout.extraCheckAct && previous.layout.extraCheckAct) {\r\n                        if (current.layout.extraCheckAct.enabled !== previous.layout.extraCheckAct.enabled) {\r\n                            changelog['Objectives'] = changelog['Objectives'] || [];\r\n                            changelog['Objectives'].push(`Check/Act comment section ${current.layout.extraCheckAct.enabled ? 'enabled' : 'disabled'}.`);\r\n                        }\r\n                        if (JSON.stringify(current.layout.extraCheckAct.text) !== JSON.stringify(previous.layout.extraCheckAct.text)) {\r\n                            changelog['Objectives'] = changelog['Objectives'] || [];\r\n                            changelog['Objectives'].push(`Check/Act comments updated.`);\r\n                        }\r\n                        if (!arraysEqual(current.layout.extraCheckAct.canEdit, previous.layout.extraCheckAct.canEdit)) {\r\n                            changelog['Objectives'] = changelog['Objectives'] || [];\r\n                            changelog['Objectives'].push(`(OWNER) Check/Act edit permissions changed.`);\r\n                        }\r\n                    }\r\n                } catch (e) { /* ignore */ }\r\n            }\r\n        }\r\n\r\n        return { changelog };\r\n    } catch (e) {\r\n        return { changelog: { 'General': ['Changelog generation failed.'] } };\r\n    }\r\n}\r\n\r\nexport default function handler(req, res) {\r\n    const { series } = req.query;\r\n    if (!series) return res.status(400).json({ error: 'Missing series id' });\r\n\r\n    const versionsPath = path.join(process.cwd(), 'src', 'data', 'A3Versions.json');\r\n    let versions = {};\r\n    if (fs.existsSync(versionsPath)) {\r\n        try { versions = JSON.parse(fs.readFileSync(versionsPath, 'utf8') || '{}'); } catch (e) { versions = {}; }\r\n    }\r\n\r\n    if (req.method === 'GET') {\r\n        const seriesObj = versions[series] || { versions: {}, history: [], currentVersion: null };\r\n        return res.status(200).json(seriesObj);\r\n    }\r\n\r\n    if (req.method === 'POST') {\r\n        const a3Path = path.join(process.cwd(), 'src', 'data', 'A3s.json');\r\n        if (!fs.existsSync(a3Path)) return res.status(500).json({ error: 'A3s data missing' });\r\n        const all = JSON.parse(fs.readFileSync(a3Path, 'utf8') || '[]');\r\n        const current = all.find(a => a.header && a.header.id && a.header.id.split('-')[1] === series);\r\n        if (!current) return res.status(404).json({ error: 'Series not found' });\r\n\r\n        versions[series] = versions[series] || {};\r\n        const existingVersions = Object.keys(versions[series] || {});\r\n        const last = existingVersions.length === 0 ? null : existingVersions.sort((a, b) => labelToNumber(a) - labelToNumber(b))[existingVersions.length - 1];\r\n        const next = last ? nextVersionLabel(last) : 'B';\r\n\r\n        const previous = last ? versions[series][last]?.snapshot || null : null;\r\n        const { changelog } = getChangeLog(current, previous);\r\n\r\n        versions[series][next] = { snapshot: current, meta: { ts: Date.now(), changelog: changelog || {} } };\r\n\r\n        fs.writeFileSync(versionsPath, JSON.stringify(versions, null, 2), 'utf8');\r\n\r\n        // update current A3 header id to new version (A3-<series>-<next>)\r\n        const idx = all.findIndex(a => a.header && a.header.id && a.header.id.split('-')[1] === series);\r\n        if (idx !== -1) {\r\n            // update id for the A3 and fix cross-references across other A3s\r\n            const oldId = all[idx].header.id;\r\n            const parts = all[idx].header.id.split('-');\r\n            parts[2] = next;\r\n            const newId = parts.join('-');\r\n            all[idx].header.id = newId;\r\n\r\n            // Update other A3s: replace refs/refBy occurrences of oldId with newId\r\n            for (let i = 0; i < all.length; i++) {\r\n                if (!all[i] || !all[i].header) continue;\r\n                // skip the updated entry\r\n                if (i === idx) continue;\r\n                if (Array.isArray(all[i].header.refs)) {\r\n                    let changed = false;\r\n                    all[i].header.refs = all[i].header.refs.map(r => {\r\n                        if (r === oldId) { changed = true; return newId; }\r\n                        return r;\r\n                    });\r\n                    if (changed) {\r\n                        // ensure uniqueness\r\n                        all[i].header.refs = Array.from(new Set(all[i].header.refs));\r\n                    }\r\n                }\r\n                if (Array.isArray(all[i].header.refBy)) {\r\n                    let changed = false;\r\n                    all[i].header.refBy = all[i].header.refBy.map(r => {\r\n                        if (r === oldId) { changed = true; return newId; }\r\n                        return r;\r\n                    });\r\n                    if (changed) {\r\n                        all[i].header.refBy = Array.from(new Set(all[i].header.refBy));\r\n                    }\r\n                }\r\n            }\r\n\r\n            fs.writeFileSync(a3Path, JSON.stringify(all, null, 2), 'utf8');\r\n        }\r\n\r\n        return res.status(201).json({ version: next, meta: versions[series][next].meta });\r\n    }\r\n\r\n    return res.status(405).json({ error: 'Method not allowed' });\r\n}\r\n","import { sendError } from \"next/dist/esm/server/api-utils\";\nimport { RouteKind } from \"next/dist/esm/server/route-kind\";\nimport { PagesAPIRouteModule } from \"next/dist/esm/server/route-modules/pages-api/module.compiled\";\nimport { hoist } from \"next/dist/esm/build/templates/helpers\";\n// Import the userland code.\nimport * as userland from \"INNER_PAGE\";\nimport { getTracer, SpanKind } from \"next/dist/esm/server/lib/trace/tracer\";\nimport { BaseServerSpan } from \"next/dist/esm/server/lib/trace/constants\";\n// Re-export the handler (should be the default export).\nexport default hoist(userland, 'default');\n// Re-export config.\nexport const config = hoist(userland, 'config');\n// Create and export the route module that will be consumed.\nconst routeModule = new PagesAPIRouteModule({\n    definition: {\n        kind: RouteKind.PAGES_API,\n        page: \"/api/a3s/[series]/versions/index\",\n        pathname: \"/api/a3s/[series]/versions\",\n        // The following aren't used in production.\n        bundlePath: '',\n        filename: ''\n    },\n    userland,\n    distDir: process.env.__NEXT_RELATIVE_DIST_DIR || '',\n    relativeProjectDir: process.env.__NEXT_RELATIVE_PROJECT_DIR || ''\n});\nexport async function handler(req, res, ctx) {\n    let srcPage = \"/api/a3s/[series]/versions/index\";\n    // turbopack doesn't normalize `/index` in the page name\n    // so we need to to process dynamic routes properly\n    // TODO: fix turbopack providing differing value from webpack\n    if (process.env.TURBOPACK) {\n        srcPage = srcPage.replace(/\\/index$/, '') || '/';\n    }\n    const prepareResult = await routeModule.prepare(req, res, {\n        srcPage\n    });\n    if (!prepareResult) {\n        res.statusCode = 400;\n        res.end('Bad Request');\n        ctx.waitUntil == null ? void 0 : ctx.waitUntil.call(ctx, Promise.resolve());\n        return;\n    }\n    const { query, params, prerenderManifest, routerServerContext } = prepareResult;\n    try {\n        const method = req.method || 'GET';\n        const tracer = getTracer();\n        const activeSpan = tracer.getActiveScopeSpan();\n        const onRequestError = routeModule.instrumentationOnRequestError.bind(routeModule);\n        const invokeRouteModule = async (span)=>routeModule.render(req, res, {\n                query: {\n                    ...query,\n                    ...params\n                },\n                params,\n                allowedRevalidateHeaderKeys: process.env.__NEXT_ALLOWED_REVALIDATE_HEADERS,\n                multiZoneDraftMode: Boolean(process.env.__NEXT_MULTI_ZONE_DRAFT_MODE),\n                trustHostHeader: process.env.__NEXT_TRUST_HOST_HEADER,\n                // TODO: get this from from runtime env so manifest\n                // doesn't need to load\n                previewProps: prerenderManifest.preview,\n                propagateError: false,\n                dev: routeModule.isDev,\n                page: \"/api/a3s/[series]/versions/index\",\n                internalRevalidate: routerServerContext == null ? void 0 : routerServerContext.revalidate,\n                onError: (...args)=>onRequestError(req, ...args)\n            }).finally(()=>{\n                if (!span) return;\n                span.setAttributes({\n                    'http.status_code': res.statusCode,\n                    'next.rsc': false\n                });\n                const rootSpanAttributes = tracer.getRootSpanAttributes();\n                // We were unable to get attributes, probably OTEL is not enabled\n                if (!rootSpanAttributes) {\n                    return;\n                }\n                if (rootSpanAttributes.get('next.span_type') !== BaseServerSpan.handleRequest) {\n                    console.warn(`Unexpected root span type '${rootSpanAttributes.get('next.span_type')}'. Please report this Next.js issue https://github.com/vercel/next.js`);\n                    return;\n                }\n                const route = rootSpanAttributes.get('next.route');\n                if (route) {\n                    const name = `${method} ${route}`;\n                    span.setAttributes({\n                        'next.route': route,\n                        'http.route': route,\n                        'next.span_name': name\n                    });\n                    span.updateName(name);\n                } else {\n                    span.updateName(`${method} ${req.url}`);\n                }\n            });\n        // TODO: activeSpan code path is for when wrapped by\n        // next-server can be removed when this is no longer used\n        if (activeSpan) {\n            await invokeRouteModule(activeSpan);\n        } else {\n            await tracer.withPropagatedContext(req.headers, ()=>tracer.trace(BaseServerSpan.handleRequest, {\n                    spanName: `${method} ${req.url}`,\n                    kind: SpanKind.SERVER,\n                    attributes: {\n                        'http.method': method,\n                        'http.target': req.url\n                    }\n                }, invokeRouteModule));\n        }\n    } catch (err) {\n        // we re-throw in dev to show the error overlay\n        if (routeModule.isDev) {\n            throw err;\n        }\n        // this is technically an invariant as error handling\n        // should be done inside of api-resolver onError\n        sendError(res, 500, 'Internal Server Error');\n    } finally{\n        // We don't allow any waitUntil work in pages API routes currently\n        // so if callback is present return with resolved promise since no\n        // pending work\n        ctx.waitUntil == null ? void 0 : ctx.waitUntil.call(ctx, Promise.resolve());\n    }\n}\n\n//# sourceMappingURL=pages-api.js.map\n","\r\nexport function isoToDateString(isoString, format = \"DD/MM/YYYY\") {\r\n  if (!isoString) return \"\";\r\n  const date = new Date(isoString);\r\n  if (isNaN(date)) return \"\";\r\n  const day = String(date.getDate()).padStart(2, '0');\r\n  const month = String(date.getMonth() + 1).padStart(2, '0');\r\n  const year = date.getFullYear();\r\n  if (format === \"DD/MM/YYYY\") return `${day}/${month}/${year}`;\r\n  if (format === \"DD/MM\") return `${day}/${month}`;\r\n  if (format === \"DD/MM/YY\") return `${day}/${month}/${String(year).slice(-2)}`;\r\n  return `${day}/${month}/${year}`;\r\n}\r\n\r\nexport function formatCommentTimestamp(input) {\r\n  if (!input) return '';\r\n  const d = input instanceof Date ? input : new Date(input);\r\n  if (isNaN(d)) return '';\r\n  const day = String(d.getDate()).padStart(2, '0');\r\n  const month = String(d.getMonth() + 1).padStart(2, '0');\r\n  const hours = String(d.getHours()).padStart(2, '0');\r\n  const minutes = String(d.getMinutes()).padStart(2, '0');\r\n  return `${day}-${month} ${hours}:${minutes}`;\r\n}\r\n\r\nexport function formatCompact(value, opts = {}) {\r\n  // opts: { locale, maxSig = 3, short = true }\r\n  const locale = opts.locale || typeof navigator !== 'undefined' ? navigator.language : 'en';\r\n  const maxSig = opts.maxSig || 3;\r\n\r\n  // Guard non-numbers\r\n  if (value === null || value === undefined || Number.isNaN(Number(value))) return String(value ?? '');\r\n\r\n  const n = Number(value);\r\n  // Try Intl compact formatting if available\r\n  try {\r\n    // Some runtimes might not support 'compact' -> this try/catch handles that\r\n    const nf = new Intl.NumberFormat(locale, {\r\n      notation: 'compact',\r\n      compactDisplay: (opts.short === false) ? 'long' : 'short',\r\n      maximumSignificantDigits: maxSig\r\n    });\r\n    return nf.format(n);\r\n  } catch (e) {\r\n    // fallback below\r\n  }\r\n\r\n  // Fallback: SI suffix with up to maxSig significant digits\r\n  const abs = Math.abs(n);\r\n  const sign = n < 0 ? '-' : '';\r\n  const tiers = [\r\n    { value: 1e12, suffix: 'T' },\r\n    { value: 1e9, suffix: 'B' },\r\n    { value: 1e6, suffix: 'M' },\r\n    { value: 1e3, suffix: 'k' }\r\n  ];\r\n\r\n  for (let i = 0; i < tiers.length; i++) {\r\n    const t = tiers[i];\r\n    if (abs >= t.value) {\r\n      const v = abs / t.value;\r\n      // preserve up to maxSig significant digits\r\n      const digits = Math.max(0, maxSig - Math.floor(Math.log10(Math.floor(v))) - 1);\r\n      let s = v.toFixed(digits);\r\n      // strip trailing zeros and decimal point\r\n      s = s.replace(/\\.?0+$/, '');\r\n      return sign + s + t.suffix;\r\n    }\r\n  }\r\n\r\n  // small numbers: format with up to maxSig significant digits\r\n  if (abs < 1) {\r\n    // for numbers < 1 show up to (maxSig) decimal places but trim\r\n    const digits = Math.max(0, maxSig - Math.floor(Math.log10(Math.floor(abs || 1))) - 1);\r\n    let s = n.toFixed(Math.min(6, maxSig + 2)); // clamp decimals so we don't show huge precision\r\n    s = s.replace(/\\.?0+$/, '');\r\n    return s;\r\n  }\r\n\r\n  // else normal int display but cap significant digits by rounding if needed\r\n  const str = String(Math.round(n));\r\n  if (str.length <= maxSig) return str;\r\n  // turn 12345 -> 12.3k (reuse logic above)\r\n  // fallback to dividing by 1k if large\r\n  const v = n / 1000;\r\n  let s = v.toPrecision(Math.min(maxSig, 3));\r\n  s = Number(s).toString();\r\n  return s + 'k';\r\n}\r\n\r\nexport function toInitialLast(name) {\r\n  if (!name) return \"\";\r\n  const [first, last] = name.trim().split(\" \");\r\n  if (!first || !last) return name;\r\n  return `${first.charAt(0).toUpperCase()}. ${capitalize(last)}`;\r\n}\r\n\r\nexport function toFullName(name) {\r\n  if (!name) return \"\";\r\n  const [first, last] = name.trim().split(\" \");\r\n  if (!first || !last) return capitalize(name);\r\n  return `${capitalize(first)} ${capitalize(last)}`;\r\n}\r\n\r\nfunction capitalize(str) {\r\n  return str.charAt(0).toUpperCase() + str.slice(1).toLowerCase();\r\n}\r\n\r\nexport function getNextA3Id(a3s) {\r\n  if (!Array.isArray(a3s) || a3s.length === 0) return \"A3-001-A\";\r\n  const numbers = a3s\r\n    .map(a3 => {\r\n      const match = a3.header?.id?.match(/^A3-(\\d+)-A$/);\r\n      return match ? parseInt(match[1], 10) : 0;\r\n    })\r\n    .filter(n => n > 0);\r\n  const maxNum = numbers.length ? Math.max(...numbers) : 0;\r\n  const nextNum = (maxNum + 1).toString().padStart(3, \"0\");\r\n  return `A3-${nextNum}-A`;\r\n}\r\n\r\nexport function getBars(initial, target, initialLabel, targetLabel, gapLabel, placeholder, unit) {\r\n  let bars = {};\r\n  if (!initial) {\r\n    if (!target.value) { // No initial and no target -> \r\n      // bars = [\"Middle\", [0, 0], \"Middle\"];\r\n      bars = {\r\n        initial: {\r\n          y: (placeholder.up === null ? \"Middle\" : placeholder.up ? \"Low\" : \"High\"),\r\n          label: initialLabel\r\n        },\r\n        gap: {\r\n          type: (placeholder.up === null ? \"none\" : placeholder.up ? \"arrow-up\" : \"arrow-down\"),\r\n          label: (placeholder.gap === null ? (placeholder.up ? \"Increase\" : \"Decrease\") : placeholder.gap),\r\n        },\r\n        target: {\r\n          y: (placeholder.up === null ? \"Middle\" : placeholder.up ? \"High\" : \"Low\"),\r\n          label: targetLabel\r\n        }\r\n      };\r\n    } else {\r\n      // barHeights = [0, [0, 0], \"Middle\"];\r\n      bars = {\r\n        initial: {\r\n          y: 0,\r\n          label: initialLabel\r\n        },\r\n        gap: {\r\n          type: \"none\",\r\n          label: gapLabel\r\n        },\r\n        target: {\r\n          y: \"Middle\",\r\n          label: targetLabel\r\n        }\r\n      };\r\n    }\r\n  }\r\n  else {\r\n    if (!target.value) {\r\n      // barHeights = [\"Middle\", [0, 0], 0];\r\n      bars = {\r\n        initial: {\r\n          y: \"Middle\",\r\n          label: initialLabel\r\n        },\r\n        gap: {\r\n          type: \"none\",\r\n          label: gapLabel\r\n        },\r\n        target: {\r\n          y: \"Middle\",\r\n          label: targetLabel\r\n        }\r\n      };\r\n    }\r\n    else {\r\n      if (Number(target.value) < Number(initial)) {\r\n        bars = {\r\n          initial: {\r\n            y: \"High\",\r\n            label: initialLabel\r\n          },\r\n          gap: {\r\n            type: \"arrow-down\",\r\n            label: formatCompact(Number(target.value) - Number(initial)) + ` (${target.percent >= 0 ? '+' : ''}${formatCompact(target.percent)}%)`\r\n          },\r\n          target: {\r\n            y: \"Low\",\r\n            label: targetLabel\r\n          }\r\n        };\r\n      } else {\r\n        bars = {\r\n          initial: {\r\n            y: \"Low\",\r\n            label: initialLabel\r\n          },\r\n          gap: {\r\n            type: \"arrow-up\",\r\n            label: formatCompact(Number(target.value) - Number(initial))\r\n          },\r\n          target: {\r\n            y: \"High\",\r\n            label: targetLabel\r\n          }\r\n        };\r\n      }\r\n    }\r\n  }\r\n  return bars;\r\n}\r\n\r\nexport function getContrastTextColor(bg) {\r\n  if (!bg) return '#000000';\r\n  const s = String(bg).trim().toLowerCase();\r\n\r\n  let r = 0, g = 0, b = 0;\r\n\r\n  if (s.startsWith('#')) {\r\n    const hex = s.slice(1);\r\n    if (hex.length === 3) {\r\n      r = parseInt(hex[0] + hex[0], 16);\r\n      g = parseInt(hex[1] + hex[1], 16);\r\n      b = parseInt(hex[2] + hex[2], 16);\r\n    } else if (hex.length === 6) {\r\n      r = parseInt(hex.slice(0, 2), 16);\r\n      g = parseInt(hex.slice(2, 4), 16);\r\n      b = parseInt(hex.slice(4, 6), 16);\r\n    } else {\r\n      return '#000000';\r\n    }\r\n  } else if (s.startsWith('rgb')) {\r\n    const m = s.match(/rgba?\\(([^)]+)\\)/);\r\n    if (m) {\r\n      const parts = m[1].split(',').map(p => parseFloat(p));\r\n      r = parts[0] || 0;\r\n      g = parts[1] || 0;\r\n      b = parts[2] || 0;\r\n    } else {\r\n      return '#000000';\r\n    }\r\n  } else {\r\n    // Unknown format - fall back to black\r\n    return '#000000';\r\n  }\r\n\r\n  // convert sRGB to linear RGB\r\n  const srgb = [r, g, b].map(v => {\r\n    const c = v / 255;\r\n    return c <= 0.03928 ? c / 12.92 : Math.pow((c + 0.055) / 1.055, 2.4);\r\n  });\r\n\r\n  const lum = 0.2126 * srgb[0] + 0.7152 * srgb[1] + 0.0722 * srgb[2];\r\n\r\n  // WCAG threshold (rough). If luminance is high, return dark text, else light text.\r\n  return lum > 0.179 ? '#000000' : '#ffffff';\r\n}\r\n\r\n\r\n\r\n\r\n"],"names":[],"mappings":"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","ignoreList":[1]}