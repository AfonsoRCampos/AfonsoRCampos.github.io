module.exports=[70406,(e,t,r)=>{t.exports=e.x("next/dist/compiled/@opentelemetry/api",()=>require("next/dist/compiled/@opentelemetry/api"))},14747,(e,t,r)=>{t.exports=e.x("path",()=>require("path"))},71119,(e,t,r)=>{let a=e.r(14747),i=e.r(22734),n=a.join(process.cwd(),"public","uploads");t.exports={UPLOADS_DIR:n,ensureUploadsDir:function(){i.existsSync(n)||i.mkdirSync(n,{recursive:!0})},sanitizeFilename:function(e){if(!e)return`${Date.now()}`;let t=a.extname(e),r=a.basename(e,t).replace(/[^a-z0-9-_\. ]/gi,"_"),i=Date.now();return`${i}-${r}${t}`},publicUrlFor:function(e){return e?`/uploads/${encodeURIComponent(e)}`:null}}},23679,e=>{"use strict";e.s(["config",()=>v,"default",()=>h,"handler",()=>w],23679);var t=e.i(26747),r=e.i(90406),a=e.i(44898),i=e.i(62950);e.s(["default",()=>p],73937);let n=e.r(22734),s=e.r(14747),{UPLOADS_DIR:o,ensureUploadsDir:l,sanitizeFilename:u,publicUrlFor:d}=e.r(71119);async function p(e,t){if("POST"!==e.method)return t.status(405).json({error:"Method not allowed"});try{l();let{filename:r,data:a}=e.body||{};if(!a)return t.status(400).json({error:"Missing data"});let i=String(a).match(/^data:([^;]+);base64,(.*)$/);if(!i)return t.status(400).json({error:"Invalid data URL"});i[1];let p=i[2],c=Buffer.from(p,"base64"),f=u(r||"file"),m=s.join(o,f);await n.promises.writeFile(m,c);let h=d(f);t.status(200).json({filename:f,url:h})}catch(e){console.error("files/upload error",e),t.status(500).json({error:"Upload failed"})}}var c=e.i(73937),f=e.i(7031),m=e.i(81927);let h=(0,i.hoist)(c,"default"),v=(0,i.hoist)(c,"config"),x=new a.PagesAPIRouteModule({definition:{kind:r.RouteKind.PAGES_API,page:"/api/files/upload",pathname:"/api/files/upload",bundlePath:"",filename:""},userland:c,distDir:".next",relativeProjectDir:""});async function w(e,r,a){let i="/api/files/upload";i=i.replace(/\/index$/,"")||"/";let n=await x.prepare(e,r,{srcPage:i});if(!n){r.statusCode=400,r.end("Bad Request"),null==a.waitUntil||a.waitUntil.call(a,Promise.resolve());return}let{query:s,params:o,prerenderManifest:l,routerServerContext:u}=n;try{let t=e.method||"GET",a=(0,f.getTracer)(),i=a.getActiveScopeSpan(),n=x.instrumentationOnRequestError.bind(x),d=async i=>x.render(e,r,{query:{...s,...o},params:o,allowedRevalidateHeaderKeys:[],multiZoneDraftMode:!1,trustHostHeader:!1,previewProps:l.preview,propagateError:!1,dev:x.isDev,page:"/api/files/upload",internalRevalidate:null==u?void 0:u.revalidate,onError:(...t)=>n(e,...t)}).finally(()=>{if(!i)return;i.setAttributes({"http.status_code":r.statusCode,"next.rsc":!1});let n=a.getRootSpanAttributes();if(!n)return;if(n.get("next.span_type")!==m.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${n.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let s=n.get("next.route");if(s){let e=`${t} ${s}`;i.setAttributes({"next.route":s,"http.route":s,"next.span_name":e}),i.updateName(e)}else i.updateName(`${t} ${e.url}`)});i?await d(i):await a.withPropagatedContext(e.headers,()=>a.trace(m.BaseServerSpan.handleRequest,{spanName:`${t} ${e.url}`,kind:f.SpanKind.SERVER,attributes:{"http.method":t,"http.target":e.url}},d))}catch(e){if(x.isDev)throw e;(0,t.sendError)(r,500,"Internal Server Error")}finally{null==a.waitUntil||a.waitUntil.call(a,Promise.resolve())}}}];

//# sourceMappingURL=%5Broot-of-the-server%5D__bb6ccf62._.js.map