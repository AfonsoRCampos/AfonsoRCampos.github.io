(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,40,e=>{"use strict";e.s(["default",()=>D],40);var t=e.i(43476),l=e.i(71645),r=e.i(73665),n=e.i(40141);function i(e){return(0,n.GenIcon)({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M572.52 241.4C518.29 135.59 410.93 64 288 64S57.68 135.64 3.48 241.41a32.35 32.35 0 0 0 0 29.19C57.71 376.41 165.07 448 288 448s230.32-71.64 284.52-177.41a32.35 32.35 0 0 0 0-29.19zM288 400a144 144 0 1 1 144-144 143.93 143.93 0 0 1-144 144zm0-240a95.31 95.31 0 0 0-25.31 3.79 47.85 47.85 0 0 1-66.9 66.9A95.78 95.78 0 1 0 288 160z"},child:[]}]})(e)}var a=e.i(84828),d=e.i(18955),o=e.i(95273),s=e.i(18566),c=e.i(91282),h=e.i(17613),u=e.i(48563),x=e.i(45009),g=e.i(43794),p=["top","left","transform","className","children","innerRef"];function f(){return(f=Object.assign.bind()).apply(this,arguments)}function m(e){var t=e.top,r=e.left,n=e.transform,i=e.className,a=e.children,d=e.innerRef,o=function(e,t){if(null==e)return{};var l,r,n={},i=Object.keys(e);for(r=0;r<i.length;r++)l=i[r],t.indexOf(l)>=0||(n[l]=e[l]);return n}(e,p);return l.default.createElement("g",f({ref:d,className:(0,g.default)("visx-group",i),transform:n||"translate("+(void 0===r?0:r)+", "+(void 0===t?0:t)+")"},o),a)}function b(e){let{progress:r=[],height:n=180,colors:i={},margin:a={top:8,right:45,bottom:27.5,left:45}}=e,d={completed:i.completed||"var(--green, #39b54a)",gap:i.gap||"#ce3131ff",totalPoint:i.totalPoint||"var(--cancel, #ffe600ff)",targetLine:i.targetLine||"var(--accent, #f39c12)",todayLine:i.todayLine||"rgba(0, 0, 0, 1)"},o=r.slice(),{data:s,todayIndex:c,maxY:h}=(0,l.useMemo)(()=>{let e=o.map((e,t)=>({idx:t,date:(null==e?void 0:e.date)||null,total:e&&null!=e.total?Number(e.total):null,completed:e&&null!=e.completed?Number(e.completed):null})),t=new Date().toISOString().slice(0,10),l=null;for(let r=0;r<e.length;r++){let n=e[r].date;if(n)if(n<=t)l=r;else break}null===l&&(l=Math.min(e.length-1,0));let r=null,n=e.map(e=>(null!==e.total&&Number.isFinite(e.total)&&(r=e.total),r)),i=null;for(let e=n.length-1;e>=0;e--)if(null!=n[e]){i=n[e];break}null==i&&(i=0);let a=0;for(let t=0;t<=l;t++)a=Math.max(a,n[t]||0,e[t].completed||0);return 0===a&&(a=1),{data:e,todayIndex:l,maxY:a}},[o]),[x,g]=(0,u.default)(),p=Math.max(300,Math.floor(g.width||760)),f=Math.max(10,p-a.left-a.right),b=Math.max(10,n-a.top-a.bottom),y=e=>a.left+f*(e/Math.max(1,s.length-1)),v=e=>a.top+b-(e||0)/h*b,j=e=>a.top+b-(e||0)/100*b,w=p>=320,k=p>=240,A=p>=420?4:p>=360?2:1,N=(()=>{let e=[];for(let t=0;t<=A;t++){let l=Math.round(h*t/A*100)/100;e.push(l)}return e.reverse()})(),S=(()=>{if(!s||0===s.length)return[];let e=s.length;if(p>=420)return[0,Math.round((e-1)*.25),Math.round((e-1)*.5),Math.round((e-1)*.75),e-1];if(p>=360)return[0,Math.round((e-1)*.5),e-1];let t=[0,e-1],l="number"==typeof c?Math.min(c,e-1):null;return null==l||t.includes(l)||t.splice(1,0,l),t})(),M=e=>e&&null!=e.total?e.total:null,C=e=>e&&null!=e.completed&&null!=e.total&&0!==Number(e.total)?Number(e.completed)/Number(e.total)*100:null;return(0,t.jsx)("div",{ref:x,style:{width:"100%"},children:(0,t.jsxs)("svg",{width:p,height:n,children:[(0,t.jsx)("rect",{x:0,y:0,width:p,height:n,fill:"transparent"}),(0,t.jsxs)(m,{children:[N.map((e,l)=>{let r=v(e);return(0,t.jsxs)("g",{children:[(0,t.jsx)("line",{x1:a.left-6,x2:p-a.right,y1:r,y2:r,stroke:"rgba(0,0,0,0.04)",strokeWidth:1}),(0,t.jsx)("text",{x:a.left-8,y:r+4,fontSize:10,fill:"#444",textAnchor:"end",children:e})]},"yt-".concat(l))}),[100,75,50,25,0].map((e,l)=>{let r=j(e);return(0,t.jsx)("g",{children:(0,t.jsx)("text",{x:p-a.right+8,y:r+4,fontSize:10,fill:"#444",textAnchor:"start",children:e})},"pt-".concat(l))}),(0,t.jsx)("line",{x1:a.left,y1:n-a.bottom,x2:a.left,y2:a.top,stroke:"#444",strokeWidth:1,strokeOpacity:.6}),(0,t.jsx)("line",{x1:p-a.right,y1:n-a.bottom,x2:p-a.right,y2:a.top,stroke:"#444",strokeWidth:1,strokeOpacity:.6}),(0,t.jsx)("line",{x1:a.left,y1:n-a.bottom,x2:p-a.right,y2:n-a.bottom,stroke:"#444",strokeWidth:1,strokeOpacity:.6}),S.map(e=>{let l=y(e),r=s[e]&&s[e].date?(e=>{if(!e)return"";try{let t=new Date(e);if(isNaN(t))return e;let l=String(t.getDate()).padStart(2,"0"),r=String(t.getMonth()+1).padStart(2,"0");return"".concat(l,"/").concat(r)}catch(t){return e}})(s[e].date):"";return(0,t.jsx)("g",{transform:"translate(".concat(l,", ").concat(n-a.bottom+14,")"),children:(0,t.jsx)("text",{x:0,y:0,fontSize:10,fill:"#444",textAnchor:"middle",children:r})},"xl-".concat(e))}),"number"==typeof c&&s[c]&&(0,t.jsx)("g",{transform:"translate(".concat(y(c),", ").concat(n-a.bottom+14,")"),children:(0,t.jsx)("text",{x:0,y:0,fontSize:10,fill:"#444",textAnchor:"middle",children:"Today"})},"today-label"),k&&(0,t.jsx)("text",{x:10,y:a.top+b/2-a.bottom,fontSize:11,fill:"#444",textAnchor:"end",transform:"rotate(-90 ".concat(10," ").concat(a.top+b/2-a.bottom,")"),children:"Tasks"}),k&&(0,t.jsx)("text",{x:p-11,y:a.top+b/2-a.bottom,fontSize:11,fill:"#444",textAnchor:"start",transform:"rotate(90 ".concat(p-11," ").concat(a.top+b/2-a.bottom,")"),children:"Percent (%)"}),w&&(0,t.jsx)("text",{x:a.left+f/2,y:n-2,fontSize:11,fill:"#444",textAnchor:"middle",children:"Timeline"}),(0,t.jsx)("path",{d:(()=>{let e=[];for(let t=0;t<s.length;t++){let l=M(s[t]);null!=l&&e.push([y(t),v(l)])}if(0===e.length)return"";let t="M ".concat(e[0][0]," ").concat(e[0][1]);for(let l=1;l<e.length;l++)t+=" L ".concat(e[l][0]," ").concat(e[l][1]);return t})(),fill:"none",stroke:d.totalPoint,strokeWidth:1.5,strokeLinecap:"round"}),(0,t.jsx)("path",{d:(()=>{let e=[];for(let t=0;t<s.length;t++){let l=C(s[t]);null!=l&&e.push([y(t),j(l)])}if(0===e.length)return"";let t="M ".concat(e[0][0]," ").concat(e[0][1]);for(let l=1;l<e.length;l++)t+=" L ".concat(e[l][0]," ").concat(e[l][1]);return t})(),fill:"none",stroke:d.completed,strokeWidth:1.5,strokeLinecap:"round"}),s.length>0&&(0,t.jsx)("line",{x1:y(0),y1:j(0),x2:y(Math.max(0,s.length-1)),y2:j(100),stroke:d.targetLine,strokeWidth:1.5,strokeDasharray:"4 4",strokeLinecap:"round"}),(()=>{let e=new Date().toISOString().slice(0,10),l=null;for(let t=0;t<s.length;t++)if(s[t].date)if(s[t].date<=e)l=t;else break;if(null==l)return null;let r=y(l);return(0,t.jsx)("line",{x1:r,y1:a.top,x2:r,y2:n-a.bottom,stroke:d.todayLine,strokeWidth:1,strokeDasharray:"2 2"})})()]})]})})}m.propTypes={top:x.default.number,left:x.default.number,transform:x.default.string,className:x.default.string,children:x.default.node,innerRef:x.default.oneOfType([x.default.string,x.default.func,x.default.object])};var y=e.i(85019),v=e.i(24771),j=e.i(45670),w=e.i(4956),k=e.i(34295);function A(e){let{metric:l={},minHeight:r=120,minWidth:n=120,unit:i=""}=e,[a,d]=(0,u.default)(),o=Math.max(n,d.width||n),s=Math.max(r,d.height||r),h=Math.max(10,Math.floor(.07*Math.min(Math.max(1,o),Math.max(1,s)))),x=Math.max(9,Math.floor(.95*h)),g=Math.max(8,Math.floor(.8*h)),p=void 0!==l.initial&&null!=l.initial?Number(l.initial):Array.isArray(l.data)&&l.data[0]?Number(l.data[0].value):null,f=null;if(Array.isArray(l.data)&&l.data.length){let e=null;for(let t of l.data){if(!t)continue;let l=t.value;if(null==l||Number.isNaN(Number(l)))continue;let r=t.date?Date.parse(t.date):NaN;Number.isFinite(r)&&(!e||r>e.dt)&&(e={dt:r,value:Number(l)})}f=e?e.value:null}let m=l&&l.target&&void 0!==l.target.value?Number(l.target.value):"number"==typeof l.target?Number(l.target):null;if(null==p||null==f||null==m||[p,f,m].some(e=>Number.isNaN(e)))return(0,t.jsx)("div",{ref:a,style:{width:"100%",height:"100%",display:"flex",alignItems:"center",justifyContent:"center",color:"#666"},children:"No data to preview"});let b=p<m,y=f?b&&f>m||!b&&f<m?0:Math.abs(m-f):Math.abs(m-p),A=f&&(b&&f>m||!b&&f<m)?Math.abs(m-f):0,N=f?b&&f<=p||!b&&f>=p?0:Math.abs(f-p)-A:0,S=[];S.push({key:"initial",label:"As Is",value:p,color:"var(--gray, #888)"}),S.push({key:"gap",label:"Gap",value:N+y+A}),S.push({key:"target",label:"To Be",value:m,color:"var(--gray, #2196f3)"});let M=Math.max(10,o-44-8),C=Math.max(10,s-18-36),R=(0,v.scaleBand)({domain:S.map(e=>e.key),range:[0,M],paddingInner:.3,paddingOuter:.1}),D=Math.max(Math.abs(p),Math.abs(f),Math.abs(m),b?Math.abs(m+A):1),L=(0,j.scaleLinear)({domain:[0,1.12*D],range:[C,0]}),T=e=>"".concat((0,c.formatCompact)(e)).concat(i?" ".concat(i):"");return(0,t.jsx)("div",{ref:a,style:{width:"100%",height:"100%"},children:(0,t.jsxs)("svg",{width:"100%",height:"100%",viewBox:"0 0 ".concat(o," ").concat(s),style:{display:"block"},children:[(0,t.jsx)("line",{x1:44,x2:44,y1:18,y2:18+C,stroke:"#444",strokeWidth:1}),[0,.5,1].map((e,l)=>{let r=Math.round(1.12*D*e*100)/100,n=18+L(r);return(0,t.jsxs)("g",{children:[(0,t.jsx)("line",{x1:38,x2:o-8,y1:n,y2:n,stroke:"rgba(0,0,0,0.04)",strokeWidth:1}),(0,t.jsx)(k.Text,{x:36,y:n+4,fontSize:g,fill:"#444",textAnchor:"end",children:(0,c.formatCompact)(r)},"yl-".concat(l))]},"yt-".concat(l))}),(0,t.jsx)("line",{x1:44,x2:44+M,y1:18+C,y2:18+C,stroke:"#444",strokeWidth:1}),(()=>{let e=R.bandwidth(),l=44+(R("initial")||0),r=18+L(Math.abs(S[0].value)),n=C-L(Math.abs(S[0].value)),i=(0,t.jsxs)("g",{children:[(0,t.jsx)(w.Bar,{x:l,y:r,width:e,height:n,fill:S[0].color}),(0,t.jsx)(k.Text,{x:l+e/2,y:Math.max(12,r-6),fontSize:x,textAnchor:"middle",fill:"#111",children:T(S[0].value)}),(0,t.jsx)(k.Text,{x:l+e/2,y:18+C+16,fontSize:h,fontWeight:"bold",textAnchor:"middle",children:S[0].label})]},"bar-initial"),a=44+(R("target")||0),d=18+L(Math.abs(S[2].value)),o=C-L(Math.abs(S[2].value)),s=(0,t.jsxs)("g",{children:[(0,t.jsx)(w.Bar,{x:a,y:d,width:e,height:o,fill:S[2].color}),(0,t.jsx)(k.Text,{x:a+e/2,y:Math.max(12,d-6),fontSize:x,textAnchor:"middle",fill:"#111",children:T(S[2].value)}),(0,t.jsx)(k.Text,{x:a+e/2,y:18+C+16,fontSize:h,fontWeight:"bold",textAnchor:"middle",children:S[2].label})]},"bar-target"),u=44+(R("gap")||0),v=[];b?(N>0&&v.push({key:"completed",value:N,color:"var(--green, #39b54a)",label:"Completed"}),y>0&&v.push({key:"debt",value:y,color:"var(--cancel, #e74c3c)",label:"Remaining"}),A>0&&v.push({key:"extra",value:A,color:"var(--green-dark, #f39c12)",label:"Extra"})):(A>0&&v.push({key:"extra",value:A,color:"var(--green-dark, #f39c12)",label:"Extra"}),y>0&&v.push({key:"debt",value:y,color:"var(--cancel, #e74c3c)",label:"Remaining"}),N>0&&v.push({key:"completed",value:N,color:"var(--green, #39b54a)",label:"Completed"}));let j=0;j=b?Math.min(p,f):m-A;let M=0;return[i,(0,t.jsxs)("g",{children:[v.map(l=>{if(!l||!l.value)return null;let r=j+M,n=18+L(j+M+l.value),i=18+L(r)-n;return M+=l.value,(0,t.jsxs)("g",{children:[(0,t.jsx)(w.Bar,{x:u,y:n,width:e,height:i,fill:l.color}),i>14&&(0,t.jsx)(k.Text,{x:u+e/2,y:n+i/2,fontSize:g,textAnchor:"middle",fill:"#fff",children:(0,c.formatCompact)(l.value)})]},"seg-".concat(l.key))}),(0,t.jsx)(k.Text,{x:u+e/2,y:18+L(j+M)-6,fontSize:x,textAnchor:"middle",fill:"#111",children:T(M)}),(0,t.jsx)(k.Text,{x:u+e/2,y:18+C+16,fontSize:h,fontWeight:"bold",textAnchor:"middle",children:S[1].label})]},"bar-gap"),s]})()]})})}var N=e.i(37216);function S(e){var l,r,n,i,a,d;let{a3:o=null,legend:s=!0}=e,h=(null==o||null==(r=o.metrics)||null==(l=r.lag)?void 0:l.data.map(e=>e.date))||[],u=[...(null==o||null==(i=o.metrics)||null==(n=i.lag)?void 0:n.metricName)?[o.metrics.lag.metricName]:[],...(null!=(d=null==o||null==(a=o.metrics)?void 0:a.leads)?d:[]).map(e=>e.metricName)],x=u.map(e=>{var t,l,r,n,i,a,d,s,c,u,x,g;let p=(null==o||null==(l=o.metrics)||null==(t=l.lag)?void 0:t.metricName)===e?o.metrics.lag.data:(null==(r=((null==o||null==(n=o.metrics)?void 0:n.leads)||[]).find(t=>t.metricName===e))?void 0:r.data)||[],f=(null==o||null==(a=o.metrics)||null==(i=a.lag)?void 0:i.metricName)===e?o.metrics.lag.target:(null==(d=((null==o||null==(s=o.metrics)?void 0:s.leads)||[]).find(t=>t.metricName===e))?void 0:d.target)||{},m=(null==o||null==(u=o.metrics)||null==(c=u.lag)?void 0:c.metricName)===e?o.metrics.lag.initial:(null==(x=((null==o||null==(g=o.metrics)?void 0:g.leads)||[]).find(t=>t.metricName===e))?void 0:x.initial)||null;return m=null==m?null:Number(m),(0,N.evaluateMetricAgainstDates)({data:p,dates:h,target:f,initial:m})}),g=h.map((e,t)=>{if(null===x[0][t])return null;let l=x.slice(1).map(e=>e[t]),r=l.filter(e=>null!==e).length;if(0===r)return null;let n=2*l.filter(e=>!0===e).length/r-1;return(!0===x[0][t]?n<0:n>0)?n:null});x=x.concat([g]);let p=[...u,"Evaluation"],f="var(--green, #2ecc71)",m="var(--cancel, #e74c3c)",b="var(--gray)";return(0,t.jsxs)("div",{className:"lags-leads-comparison",style:s?{display:"flex",gap:12,color:"#333"}:{display:"block",color:"#333"},children:[(0,t.jsx)("div",{style:s?{flex:"0 0 75%",overflowX:"auto"}:{flex:"1 1 100%",overflowX:"auto"},children:(0,t.jsxs)("table",{style:{borderCollapse:"collapse",width:"100%",tableLayout:"fixed"},children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{style:{textAlign:"left",padding:"6px 8px",width:"20%"},children:"Metric / Date"}),h.map((e,l)=>(0,t.jsx)("th",{style:{padding:"6px 4px",fontSize:"0.5em",textAlign:"center",minWidth:20},title:e,children:(0,c.isoToDateString)(e,"DD/MM")},"dh-".concat(l)))]})}),(0,t.jsx)("tbody",{children:x.map((e,l)=>(0,t.jsxs)("tr",{children:[(0,t.jsx)("td",{style:{padding:"6px 8px",borderTop:"1px solid rgba(0,0,0,0.04)",verticalAlign:"middle",fontSize:13,fontWeight:l===x.length-1?700:500},children:p[l]||""}),e.map((e,r)=>{if(l===x.length-1){if(null===e)return(0,t.jsx)("td",{style:{padding:6,textAlign:"center",borderTop:"1px solid rgba(0,0,0,0.04)"}},"c-".concat(l,"-").concat(r));let n=3+Math.round(10*Math.min(1,Math.abs(e))),i=e>0?"#ff7043":"#8e44ad";return(0,t.jsx)("td",{style:{padding:6,textAlign:"center",borderTop:"1px solid rgba(0,0,0,0.04)"},children:(0,t.jsx)("div",{title:"alert ".concat(e.toFixed(2)),style:{width:n,height:n,borderRadius:"50%",background:i,margin:"0 auto"}})},"c-".concat(l,"-").concat(r))}let n=!0===e?f:!1===e?m:b;return(0,t.jsx)("td",{style:{padding:4,textAlign:"center",borderTop:"1px solid rgba(0,0,0,0.04)"},children:(0,t.jsx)("div",{style:{width:"10px",height:"10px",margin:"0 auto",borderRadius:4,background:n}})},"c-".concat(l,"-").concat(r))})]},"r-".concat(l)))})]})}),s&&(0,t.jsxs)("div",{style:{flex:"0 0 25%",minWidth:160,padding:8,borderLeft:"1px solid rgba(0,0,0,0.04)"},children:[(0,t.jsx)("div",{style:{fontWeight:700,marginBottom:8},children:"Legend & Notes"}),(0,t.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:8},children:[(0,t.jsxs)("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[(0,t.jsx)("div",{style:{width:14,height:10,background:f,borderRadius:2}}),(0,t.jsx)("div",{style:{fontSize:13},children:"Meets target"})]}),(0,t.jsxs)("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[(0,t.jsx)("div",{style:{width:14,height:10,background:m,borderRadius:2}}),(0,t.jsx)("div",{style:{fontSize:13},children:"Does not meet target"})]}),(0,t.jsxs)("div",{style:{display:"flex",gap:8,alignItems:"center"},children:[(0,t.jsx)("div",{style:{width:14,height:10,background:b,borderRadius:2}}),(0,t.jsx)("div",{style:{fontSize:13},children:"No data / unknown"})]}),(0,t.jsx)("div",{style:{height:1,background:"rgba(0,0,0,0.04)",margin:"8px 0"}}),(0,t.jsx)("div",{style:{fontSize:13,fontWeight:600},children:"Evaluation circle"}),(0,t.jsxs)("div",{style:{fontSize:12,color:"#444"},children:["Circle appears when lag and lead progress is mismatched.",(0,t.jsx)("br",{}),"Size varies with the magnitude of the mismatch.",(0,t.jsx)("br",{}),"Color:",(0,t.jsx)("br",{}),"orange - LAG is regressing but LEADs are progressing;",(0,t.jsx)("br",{}),"purple - LAG is progressing but LEADs are regressing."]})]})]})]})}function M(e){let{color:l="#000",label:r="",dashed:n=!1,hidden:i=!1,solid:a=!1}=e;return i?null:(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:6,fontSize:12,color:"#333"},children:[(0,t.jsx)("div",{style:{position:"relative",width:18,height:8,background:a||n?"transparent":l,borderTop:n?"2px dashed ".concat(l):a?"2px solid ".concat(l):"none",top:a||n?4:0}}),(0,t.jsx)("div",{children:r})]})}function C(e){var r,n,i,a,d,o,s,c,h;let{open:u,a3:x,onClose:g}=e,[p,f]=(0,l.useState)(!1);return((0,l.useEffect)(()=>{if(!u)return;let e=e=>{"Escape"===e.key&&g&&g()};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[u,g]),u&&x)?(0,t.jsx)("div",{style:{position:"fixed",top:0,left:0,width:"100vw",height:"100vh",background:"rgba(0,0,0,0.45)",display:"flex",alignItems:"center",justifyContent:"center",zIndex:1e3,padding:20},onClick:()=>{g&&g()},children:(0,t.jsxs)("div",{role:"dialog","aria-modal":"true",style:{background:"white",borderRadius:8,width:"90%",maxHeight:"90vh",overflow:"hidden",boxShadow:"0 8px 24px rgba(0,0,0,0.2)",display:"flex",flexDirection:"column"},onClick:e=>e.stopPropagation(),children:[(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"12px 12px",borderBottom:"1px solid rgba(0,0,0,0.06)"},children:[(0,t.jsx)("h3",{style:{margin:0},children:(null==x||null==(r=x.header)?void 0:r.title)||(null==x||null==(n=x.header)?void 0:n.id)||"A3 Details"}),(0,t.jsx)("div",{style:{display:"flex",gap:8},children:(0,t.jsx)("button",{onClick:()=>{g&&g()},style:{cursor:"pointer",padding:"6px 10px",borderRadius:6,border:"none",background:"var(--cancel)",color:"white"},children:"Close"})})]}),(0,t.jsxs)("div",{style:{padding:12,overflow:"auto"},children:[(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:12,flexWrap:"wrap"},children:[(0,t.jsx)("div",{style:{display:"flex",alignItems:"center",gap:12},children:(0,t.jsx)("h4",{style:{margin:0},children:(0,t.jsx)("u",{children:"Action Plan Progress"})})}),(0,t.jsx)("div",{style:{flex:1}}),(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:12},children:[(0,t.jsx)(M,{color:"var(--green)",label:"Progress (%)",solid:!0}),(0,t.jsx)(M,{color:"var(--cancel)",label:"Total Tasks",solid:!0}),(0,t.jsx)(M,{color:"var(--accent)",label:"Prog. Target",dashed:!0})]})]}),(0,t.jsx)("div",{style:{margin:"8px 0 18px 0"},children:(0,t.jsx)(b,{progress:(null==x?void 0:x.progress)||[],height:200,percent:p})}),(0,t.jsx)("h4",{children:(0,t.jsxs)("u",{children:["LAG Measure (",null==(i=x.metrics)?void 0:i.lag.metricName," (",null==(a=x.metrics)?void 0:a.lag.unit,"))"]})}),(0,t.jsxs)("div",{style:{margin:"8px 0 18px 0",height:200,display:"flex",flexDirection:"row",gap:12},children:[(0,t.jsx)("div",{style:{flex:"0 0 30%",minWidth:0,height:"100%"},children:(0,t.jsx)(A,{metric:(null==(d=x.metrics)?void 0:d.lag)||{},minHeight:200,unit:(null==(s=x.metrics)||null==(o=s.lag)?void 0:o.unit)||""})}),(0,t.jsx)("div",{style:{flex:"0 0 70%",minWidth:0,height:"100%"},children:(0,t.jsx)(y.default,{metric:(null==(c=x.metrics)?void 0:c.lag)||{},showZones:!1,showGrid:!1,targetLine:!0,bgColor:"transparent",minHeight:200,style:{width:"100%",height:"100%"}})})]}),(null==(h=x.metrics)?void 0:h.leads)&&(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("h4",{children:(0,t.jsx)("u",{children:"LAG vs LEADS"})}),(0,t.jsx)(S,{a3:x})]})]})]})}):null}var R=e.i(23967);function D(){let{user:e}=(0,d.useUser)(),n=(0,s.useRouter)();(0,l.useEffect)(()=>{e||n.push("/")},[e,n]);let u=e?e.split(" ").map(e=>e.charAt(0).toUpperCase()+e.slice(1).toLowerCase()).join(" "):"",{a3s:x=[],setA3s:g}=(0,o.useA3s)();(0,l.useEffect)(()=>{Array.isArray(x)&&0!==x.length&&(async()=>{let e=[];for(let l of x)if(l)try{let t=(0,R.ensureLateFlagsForA3)(l);t=(0,R.ensureProgressForA3)(t),JSON.stringify(t)!==JSON.stringify(l)&&(e.push(t),g(e=>{let l=e.findIndex(e=>{var l,r;return(null==e||null==(l=e.header)?void 0:l.id)===(null==t||null==(r=t.header)?void 0:r.id)});if(-1===l)return e;let r=[...e];return r[l]=t,r}))}catch(e){var t;console.warn("Auto-update error for A3",null==l||null==(t=l.header)?void 0:t.id,e)}0!==e.length&&(await Promise.all(e.map(async e=>{var t,l;try{let l=await fetch("/api/a3s",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!l.ok){let r=await l.text().catch(()=>"");console.warn("Auto-save failed for",null==e||null==(t=e.header)?void 0:t.id,l.status,r)}}catch(t){console.warn("Auto-save failed for",null==e||null==(l=e.header)?void 0:l.id,t)}})),n&&"function"==typeof n.refresh&&n.refresh())})()},[x,g,n]);let[p,f]=(0,l.useState)(!1),[m,b]=(0,l.useState)(null),[y,v]=(0,l.useState)(!1),[j,w]=(0,l.useState)(null),[k,N]=(0,l.useState)("all"),[S,M]=(0,l.useState)("all"),[D,L]=(0,l.useState)("all"),[T,I]=(0,l.useState)("id:asc"),z=(x||[]).filter(t=>{if(!t||!t.header)return!1;let l=t.header.owner,r=Array.isArray(t.header.team)?t.header.team:[];return l===e||r.includes(e)}),W=(0,l.useMemo)(()=>{let t=z.slice();"draft"===k?t=t.filter(e=>null==e?void 0:e.draft):"published"===k&&(t=t.filter(e=>null==e?void 0:e.published)),"owner"===S?t=t.filter(t=>t.header.owner===e):"team"===S&&(t=t.filter(t=>{let l=t.header.owner,r=Array.isArray(t.header.team)?t.header.team:[];return l!==e&&r.includes(e)}));let l=new Date;"upcoming"===D?t=t.filter(e=>{var t;return((null==e||null==(t=e.header)?void 0:t.start)?new Date(e.header.start):null)>l}):"ongoing"===D?t=t.filter(e=>{var t,r;let n=(null==e||null==(t=e.header)?void 0:t.start)?new Date(e.header.start):null,i=(null==e||null==(r=e.header)?void 0:r.end)?new Date(e.header.end):null;return n<=l&&i>=l}):"finished"===D?t=t.filter(e=>{var t;return!!e&&!!e.header&&!!e.header.end&&((null==e||null==(t=e.header)?void 0:t.end)?new Date(e.header.end):null)<l}):"none"===D&&(t=t.filter(e=>{var t,l;let r=(null==e||null==(t=e.header)?void 0:t.start)?new Date(e.header.start):null,n=(null==e||null==(l=e.header)?void 0:l.end)?new Date(e.header.end):null;return!r&&!n}));let[r,n]=(T||"id:asc").split(":"),i="desc"===n?-1:1,a=e=>{if(!e)return null;let t=new Date(e);return isNaN(t)?null:t};return t.sort((e,t)=>{var l,n,d,o,s,c,h,u;if("id"===r){let r=String((null==e||null==(l=e.header)?void 0:l.id)||""),a=String((null==t||null==(n=t.header)?void 0:n.id)||"");return r.localeCompare(a)*i}if("title"===r){let l=String((null==e||null==(d=e.header)?void 0:d.title)||"").toLowerCase(),r=String((null==t||null==(o=t.header)?void 0:o.title)||"").toLowerCase();return l.localeCompare(r)*i}if("start"===r||"end"===r){let l=a(null==e||null==(s=e.header)?void 0:s.start),n=a(null==t||null==(c=t.header)?void 0:c.start),d="start"===r?l:a(null==e||null==(h=e.header)?void 0:h.end),o="start"===r?n:a(null==t||null==(u=t.header)?void 0:u.end);return null===d&&null===o?0:null===d?+i:null===o?-1*i:(d-o)*i}return 0}),t},[z,k,T,S,D,e]),O=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;return e&&0!==e.length?(e||[]).filter(e=>e!==t).map(c.toInitialLast).join(", "):"-"},E=async e=>{if(e&&confirm("Delete A3 ".concat(e,"? This operation cannot be undone.")))try{let t=await fetch("/api/a3s",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e})});if(!t.ok){let e=await t.json().catch(()=>null);alert((null==e?void 0:e.error)||"Failed to delete A3");return}n&&"function"==typeof n.refresh&&n.refresh()}catch(e){console.error("Delete failed",e),alert("Delete failed")}};return e?(0,t.jsxs)("main",{style:{minHeight:"100vh",display:"flex",flexDirection:"column"},children:[(0,t.jsx)("div",{style:{height:"5vh",display:"flex",alignItems:"center",justifyContent:"center"},children:(0,t.jsxs)("h1",{style:{margin:0},children:["Welcome, ",(0,t.jsx)("strong",{children:u}),"!"]})}),(0,t.jsxs)("div",{style:{height:"5vh",padding:"0px 16px",display:"flex",alignItems:"center",justifyContent:"center",gap:12,fontSize:12},children:[(0,t.jsxs)("div",{style:{display:"flex",gap:0,alignItems:"center",height:"3vh"},children:[(0,t.jsx)("button",{onClick:()=>N("all"),style:{padding:"0px 10px",borderRadius:"6px 0 0 6px",border:"1px solid rgba(0,0,0,0.06)",background:"all"===k?"var(--gray-dark)":"transparent",color:"all"===k?"white":"inherit",cursor:"pointer"},children:"All"}),(0,t.jsx)("button",{onClick:()=>N("draft"),style:{padding:"0px 10px",borderRadius:"0",border:"1px solid rgba(0,0,0,0.06)",borderLeft:"none",background:"draft"===k?"var(--gray)":"transparent",color:"draft"===k?"white":"inherit",cursor:"pointer"},children:"Draft"}),(0,t.jsx)("button",{onClick:()=>N("published"),style:{padding:"0px 10px",borderRadius:"0 6px 6px 0",border:"1px solid rgba(0,0,0,0.06)",borderLeft:"none",background:"published"===k?"var(--accent)":"transparent",color:"published"===k?"white":"inherit",cursor:"pointer"},children:"Published"})]}),(0,t.jsxs)("div",{style:{display:"flex",gap:0,alignItems:"center",height:"3vh"},children:[(0,t.jsx)("button",{onClick:()=>M("all"),style:{padding:"0px 10px",borderRadius:"6px 0 0 6px",border:"1px solid rgba(0,0,0,0.06)",background:"all"===S?"var(--gray-dark)":"transparent",color:"all"===S?"white":"inherit",cursor:"pointer"},children:"All"}),(0,t.jsx)("button",{onClick:()=>M("owner"),style:{padding:"0px 10px",borderRadius:"0",border:"1px solid rgba(0,0,0,0.06)",borderLeft:"none",background:"owner"===S?"var(--main)":"transparent",color:"owner"===S?"white":"inherit",cursor:"pointer"},children:"Owner"}),(0,t.jsx)("button",{onClick:()=>M("team"),style:{padding:"0px 10px",borderRadius:"0 6px 6px 0",border:"1px solid rgba(0,0,0,0.06)",borderLeft:"none",background:"team"===S?"var(--cancel)":"transparent",color:"team"===S?"white":"inherit",cursor:"pointer"},children:"Team Member"})]}),(0,t.jsxs)("div",{style:{display:"flex",gap:0,alignItems:"center",height:"3vh"},children:[(0,t.jsx)("button",{onClick:()=>L("all"),style:{padding:"0px 10px",borderRadius:"6px 0 0 6px",border:"1px solid rgba(0,0,0,0.06)",background:"all"===D?"var(--gray-dark)":"transparent",color:"all"===D?"white":"inherit",cursor:"pointer"},children:"All"}),(0,t.jsx)("button",{onClick:()=>L("upcoming"),style:{padding:"0px 10px",borderRadius:"0",border:"1px solid rgba(0,0,0,0.06)",borderLeft:"none",background:"upcoming"===D?"var(--orange)":"transparent",color:"upcoming"===D?"white":"inherit",cursor:"pointer"},children:"Upcoming"}),(0,t.jsx)("button",{onClick:()=>L("ongoing"),style:{padding:"0px 10px",borderRadius:"0",border:"1px solid rgba(0,0,0,0.06)",borderLeft:"none",background:"ongoing"===D?"var(--green)":"transparent",color:"ongoing"===D?"white":"inherit",cursor:"pointer"},children:"Ongoing"}),(0,t.jsx)("button",{onClick:()=>L("finished"),style:{padding:"0px 10px",borderRadius:"0",border:"1px solid rgba(0,0,0,0.06)",borderLeft:"none",background:"finished"===D?"var(--blue)":"transparent",color:"finished"===D?"white":"inherit",cursor:"pointer"},children:"Finished"}),(0,t.jsx)("button",{onClick:()=>L("none"),style:{padding:"0px 10px",borderRadius:"0 6px 6px 0",border:"1px solid rgba(0,0,0,0.06)",borderLeft:"none",background:"none"===D?"var(--gray-dark)":"transparent",color:"none"===D?"white":"inherit",cursor:"pointer"},children:"None"})]}),(0,t.jsxs)("div",{style:{display:"flex",alignItems:"center",gap:8},children:[(0,t.jsx)("label",{style:{fontSize:12,color:"var(--gray-dark)"},children:"Sort"}),(0,t.jsxs)("select",{value:T,onChange:e=>I(e.target.value),style:{borderRadius:6,border:"1px solid rgba(0,0,0,0.1)",padding:"4px 8px"},children:[(0,t.jsx)("option",{value:"id:asc",children:"ID (asc)"}),(0,t.jsx)("option",{value:"id:desc",children:"ID (desc)"}),(0,t.jsx)("option",{value:"title:asc",children:"Title (asc)"}),(0,t.jsx)("option",{value:"title:desc",children:"Title (desc)"}),(0,t.jsx)("option",{value:"start:asc",children:"Start (asc)"}),(0,t.jsx)("option",{value:"start:desc",children:"Start (desc)"}),(0,t.jsx)("option",{value:"end:asc",children:"End (asc)"}),(0,t.jsx)("option",{value:"end:desc",children:"End (desc)"})]})]})]}),(0,t.jsx)("div",{style:{height:"90vh",padding:16,overflow:"auto"},children:(0,t.jsxs)("table",{style:{width:"100%",borderCollapse:"collapse",fontSize:12},children:[(0,t.jsx)("thead",{children:(0,t.jsxs)("tr",{style:{borderBottom:"1px solid rgba(0,0,0,0.08)"},children:[(0,t.jsx)("th",{className:"cell-scroll",style:{padding:"8px",width:"2.5%",textAlign:"center",borderRight:"1px solid rgba(0,0,0,0.08)"},children:"ID"}),(0,t.jsx)("th",{className:"cell-scroll",style:{padding:"8px",width:"2.5%",textAlign:"center",borderRight:"1px solid rgba(0,0,0,0.08)"},children:"Ver."}),(0,t.jsx)("th",{className:"cell-scroll",style:{padding:"8px",width:"10%",textAlign:"center",borderRight:"1px solid rgba(0,0,0,0.08)"},children:"Title"}),(0,t.jsx)("th",{className:"cell-scroll",style:{padding:"8px",width:"10%",textAlign:"center",borderRight:"1px solid rgba(0,0,0,0.08)"},children:"Time span"}),(0,t.jsx)("th",{className:"cell-scroll",style:{padding:"8px",width:"5%",textAlign:"center",borderRight:"1px solid rgba(0,0,0,0.08)"},children:"Owner"}),(0,t.jsx)("th",{className:"cell-scroll",style:{padding:"8px",width:"20%",textAlign:"center",borderRight:"1px solid rgba(0,0,0,0.08)"},children:"Team"}),(0,t.jsx)("th",{className:"cell-scroll",style:{padding:"8px",width:"15%",textAlign:"center",borderRight:"1px solid rgba(0,0,0,0.08)"},children:"Tags"}),(0,t.jsx)("th",{className:"cell-scroll",style:{padding:"8px",width:"10%",textAlign:"center",borderRight:"1px solid rgba(0,0,0,0.08)"},children:"Actions"}),(0,t.jsx)("th",{className:"cell-scroll",style:{padding:"8px",width:"15%",textAlign:"center"},children:"Detail (Click to Expand)"})]})}),(0,t.jsxs)("tbody",{children:[W.map(l=>{var d,o,s,h,u,x,g,p;let m=(null==l||null==(d=l.header)?void 0:d.id)||"",y=String(m).split("-"),j=y[1]||"",k=y[2]||"",N=null==l||null==(o=l.header)?void 0:o.owner,S=Array.isArray(null==l||null==(s=l.header)?void 0:s.team)?l.header.team:[],M=N===e,C=!M&&S.includes(e),R=null==l||null==(h=l.header)?void 0:h.start,D=null==l||null==(u=l.header)?void 0:u.end,L=null==l||null==(x=l.header)?void 0:x.lastUpdated,T=null==l||null==(g=l.metrics)?void 0:g.lag,I=e=>{if(!e)return null;let t=new Date(e);return isNaN(t)?null:t},z=e=>{let t=I(e);if(!t)return"";let l=String(t.getDate()).padStart(2,"0"),r=String(t.getMonth()+1).padStart(2,"0"),n=String(t.getFullYear()).slice(-2);return"".concat(l,"/").concat(r,"/").concat(n)},W=I(R),P=I(D);z(I(L));let F=new Date,B=e=>e?new Date(e.getFullYear(),e.getMonth(),e.getDate()):null,U=B(F),G=B(W),H=B(P),J="-";if(W||P){let e=W?z(W):"—",t=P?z(P):"—";J="".concat(e," to ").concat(t)}let V=null;return(G||H)&&(G&&H?V=U>=G&&U<=H?"Ongoing":U<G?"Upcoming":"Finished":G&&!H?V=U>=G?"Ongoing":"Upcoming":!G&&H&&(V=U<=H?"Ongoing":"Finished")),(0,t.jsxs)("tr",{style:{borderBottom:"1px solid rgba(0,0,0,0.04)"},children:[(0,t.jsx)("td",{className:"cell-scroll",style:{padding:"8px",verticalAlign:"middle",textAlign:"center",borderRight:"1px solid rgba(0,0,0,0.04)"},children:j}),(0,t.jsx)("td",{className:"cell-scroll",style:{padding:"8px",verticalAlign:"middle",textAlign:"center",borderRight:"1px solid rgba(0,0,0,0.04)"},children:k}),(0,t.jsx)("td",{className:"cell-scroll",style:{padding:"8px",verticalAlign:"middle",textAlign:"center",borderRight:"1px solid rgba(0,0,0,0.04)"},children:(null==l||null==(p=l.header)?void 0:p.title)||"(untitled)"}),(0,t.jsx)("td",{className:"cell-scroll",style:{padding:"8px",verticalAlign:"middle",textAlign:"center",borderRight:"1px solid rgba(0,0,0,0.04)"},children:J}),(0,t.jsx)("td",{className:"cell-scroll",style:{padding:"8px",verticalAlign:"middle",textAlign:"center",borderRight:"1px solid rgba(0,0,0,0.04)"},children:(0,c.toInitialLast)(N)}),(0,t.jsx)("td",{className:"cell-scroll",style:{padding:"8px",verticalAlign:"middle",textAlign:"center",borderRight:"1px solid rgba(0,0,0,0.04)"},children:O(S,N)}),(0,t.jsx)("td",{className:"cell-scroll",style:{padding:"8px",verticalAlign:"middle",textAlign:"center",borderRight:"1px solid rgba(0,0,0,0.04)"},children:(0,t.jsx)("div",{style:{display:"flex",gap:8,alignItems:"center",justifyContent:"center",flexWrap:"wrap"},children:(()=>{let e=[];return(null==l?void 0:l.published)?e.push({key:"published",text:"Published",bg:"var(--accent)"}):(null==l?void 0:l.draft)&&e.push({key:"draft",text:"Draft",bg:"var(--gray)"}),M?e.push({key:"owner",text:"Owner",bg:"var(--main)"}):C&&e.push({key:"team",text:"Team Member",bg:"var(--cancel)"}),V&&e.push({key:"schedule:".concat(V),text:V,bg:"Ongoing"===V?"var(--green)":"Upcoming"===V?"var(--orange)":"var(--blue)"}),e.slice(0,3).map(e=>(0,t.jsx)("span",{style:{background:e.bg,color:"white",padding:"4px 8px",borderRadius:12},children:e.text},e.key))})()})}),(0,t.jsx)("td",{style:{padding:"8px",verticalAlign:"middle",textAlign:"center",borderRight:"1px solid rgba(0,0,0,0.04)"},children:(0,t.jsx)("div",{style:{width:"100%",padding:2},children:(0,t.jsxs)("div",{style:{display:"flex",gap:8,alignItems:"center",justifyContent:"center"},children:[(0,t.jsx)("button",{title:"Edit A3",onClick:()=>n.push("/a3/".concat(encodeURIComponent(m),"/edit")),style:{flex:"1 1 0",maxWidth:"20%",aspectRatio:"1 / 1",borderRadius:"50%",border:"none",display:"flex",alignItems:"center",justifyContent:"center",background:"var(--main)",color:"white",cursor:"pointer",padding:0},"aria-label":"Edit",children:(0,t.jsx)(r.MdOutlineEdit,{size:15})}),(0,t.jsx)("button",{title:"View",onClick:()=>n.push("/a3/".concat(encodeURIComponent(m),"/view")),style:{flex:"1 1 0",maxWidth:"20%",aspectRatio:"1 / 1",borderRadius:"50%",border:"none",display:"flex",alignItems:"center",justifyContent:"center",background:"var(--orange)",color:"white",cursor:"pointer",padding:0},"aria-label":"View A3",children:(0,t.jsx)(i,{size:15})}),(0,t.jsx)("button",{title:"Download (A3 sheet)",onClick:()=>{b(l),f(!0)},style:{flex:"1 1 0",maxWidth:"20%",aspectRatio:"1 / 1",borderRadius:"50%",border:"none",display:"flex",alignItems:"center",justifyContent:"center",background:"var(--green)",color:"white",cursor:"pointer",padding:0},"aria-label":"Download",children:(0,t.jsx)(a.FaDownload,{size:11})}),(0,t.jsx)("button",{title:"Delete A3",onClick:()=>E(m),style:{flex:"1 1 0",maxWidth:"20%",aspectRatio:"1 / 1",borderRadius:"50%",border:"none",display:"flex",alignItems:"center",justifyContent:"center",background:"var(--cancel)",color:"white",cursor:"pointer",padding:0},"aria-label":"Delete",children:(0,t.jsx)(r.MdDelete,{size:15})})]})})}),(0,t.jsx)("td",{className:"cell-scroll",style:{padding:"8px",verticalAlign:"middle",textAlign:"center"},onClick:()=>{w(l),v(!0)},children:(0,t.jsx)("div",{style:{width:"100%",height:"100%"},children:(0,t.jsx)(A,{metric:T,unit:null==T?void 0:T.unit})})})]},m)}),0===W.length&&(0,t.jsx)("tr",{children:(0,t.jsx)("td",{colSpan:8,style:{padding:16,color:"#666"},children:"No A3s to show"})})]})]})}),p&&(0,t.jsx)(h.default,{a3:m,format:"A3",onFinish:()=>{f(!1),b(null)}}),(0,t.jsx)(C,{open:y,a3:j,onClose:()=>{v(!1),w(null)}})]}):null}}]);