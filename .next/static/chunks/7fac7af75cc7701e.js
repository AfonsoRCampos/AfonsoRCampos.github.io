(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,70593,e=>{"use strict";e.s(["default",()=>l]);var t=e.i(43476),i=e.i(71645);function l(e){let{id:l,value:n,onChange:r,width:s="100%",height:a="2.5em",borderColor:o="var(--main)",bgColor:d="white",hoverColor:c="white",style:u={},placeholder:h="Enter text...",min:g,max:v,...f}=e,[p,x]=i.default.useState(!1),m=f.options,y={width:s,height:a,border:"1px solid ".concat(o),background:p?c:d,borderRadius:"6px",padding:"0.25em 0.75em",fontSize:"1em",transition:"background 0.2s, border-color 0.2s",boxSizing:"border-box",color:"black",...u};return m&&Array.isArray(m)?(0,t.jsx)("select",{id:l,value:n,onChange:r,style:y,onMouseEnter:()=>x(!0),onMouseLeave:()=>x(!1),...f,placeholder:h,children:m.map((e,i)=>{var l;if("string"==typeof e)return(0,t.jsx)("option",{value:e,children:e},i);let n=!!e.disabled,r=e.title||void 0;return(0,t.jsx)("option",{value:e.value,disabled:n,title:r,children:null!=(l=e.label)?l:e.value},i)})}):(0,t.jsx)("input",{id:l,type:f.type||"text",value:n,onChange:e=>{if(r){if(("number"===f.type||"numeric"===f.inputMode||"decimal"===f.inputMode)&&(void 0!==g||void 0!==v)){var t,i;let l=null!=(i=null==e||null==(t=e.target)?void 0:t.value)?i:"";if(""===l)return void r({target:{value:""}});let n=parseFloat(l);if(Number.isNaN(n))return void r(e);let s=n;return void 0!==g&&(s=Math.max(Number(g),s)),void 0!==v&&(s=Math.min(Number(v),s)),void(s!==n?r({target:{value:String(s)}}):r(e))}r(e)}},placeholder:h,style:y,onMouseEnter:()=>x(!0),onMouseLeave:()=>x(!1),min:g,max:v,...f})}},16180,e=>{"use strict";e.s(["default",()=>c]);var t=e.i(43476),i=e.i(71645),l=e.i(18566),n=e.i(18955),r=e.i(95273),s=e.i(48563),a=e.i(50341),o=e.i(17613);e.i(70593);var d=e.i(23967);function c(){var e,c;let u=(0,l.useParams)(),h=(0,l.useRouter)(),{user:g}=(0,n.useUser)(),{a3s:v=[]}=(0,r.useA3s)(),f=(null==u?void 0:u.id)||"",[p,x]=(0,i.useState)(null),[m,y]=(0,i.useState)(null),[b,j]=(0,i.useState)([]),[S,A]=(0,i.useState)(!1),[w,C]=(0,i.useState)("CURRENT"),[k,R]=(0,i.useState)("A3"),[T,L]=(0,i.useState)(!1),[N,P]=(0,s.default)();return((0,i.useEffect)(()=>{var e,t;let i=(v||[]).find(e=>{var t;return(null==e||null==(t=e.header)?void 0:t.id)===f})||null;if(!i)return;let l=null==(e=i.header)?void 0:e.owner,n=Array.isArray(null==(t=i.header)?void 0:t.team)?i.header.team:[];if(!(l===g||n.includes(g)))return void h.push("/home");try{let e=(0,d.ensureLateFlagsForA3)(i);e=(0,d.ensureProgressForA3)(e);let t=JSON.stringify(e)!==JSON.stringify(i);x(e),y(e),t&&(async()=>{try{let t=await fetch("/api/a3s",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(!t.ok){let e=await t.text().catch(()=>"");console.warn("Auto-save late flags/progress failed",t.status,e)}}catch(e){console.warn("Auto-save late flags/progress error",e)}})()}catch(e){x(i),y(i)}},[v,f,h,g]),(0,i.useEffect)(()=>{var e;if(!p)return;let t=((null==(e=p.header)?void 0:e.id)||"").split("-");if(t.length<3)return;let i=t[1];A(!0),fetch("/api/a3s/".concat(i,"/versions")).then(e=>e.json()).then(e=>{let t=e||{},i={};t.versions&&"object"==typeof t.versions?i=t.versions:Object.keys(t).forEach(e=>{"history"!==e&&"currentVersion"!==e&&t[e]&&t[e].snapshot&&(i[e]=t[e])});let l=Object.keys(i).map(e=>({label:e,snapshot:i[e].snapshot||null,meta:i[e].meta||{}}));l.sort((e,t)=>{var i,l;return((null==(i=t.meta)?void 0:i.ts)||0)-((null==(l=e.meta)?void 0:l.ts)||0)}),j(l)}).catch(()=>j([])).finally(()=>A(!1))},[p]),m)?(0,t.jsxs)("main",{style:{padding:16,display:"flex",gap:16},children:[(0,t.jsx)("div",{style:{flex:"0 0 80%",minWidth:0,display:"flex",flexDirection:"column",gap:12},children:(0,t.jsx)("div",{style:{flex:1,minWidth:0,justifyContent:"center",alignItems:"center",display:"flex"},children:(0,t.jsx)("div",{style:{width:"100%",display:"flex",justifyContent:"center",alignItems:"center"},children:(0,t.jsx)(a.default,{a3:m,refPreview:N,boundsPreview:P,setA3:()=>{},setActiveArea:()=>{},setShowLayout:()=>{},toggleImgSelectorCurrent:()=>{},toggleImgSelectorActionPlan:()=>{},editable:!1})})})}),(0,t.jsxs)("aside",{style:{flex:"1 1 30%",boxSizing:"border-box",borderLeft:"1px solid rgba(0,0,0,0.06)",paddingLeft:12,display:"flex",flexDirection:"column",height:"calc(100vh - 32px)"},children:[(0,t.jsx)("h3",{style:{marginTop:0},children:"Versions"}),S?(0,t.jsx)("div",{children:"Loading versions…"}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsxs)("div",{style:{flex:1,overflowY:"auto",display:"flex",flexDirection:"column",gap:8,paddingRight:8},children:[(0,t.jsx)("div",{style:{display:"flex",gap:8,alignItems:"center"},children:(0,t.jsxs)("div",{onClick:()=>{y(p),C("CURRENT")},style:{padding:8,borderRadius:6,background:"CURRENT"===w?"#eef":"transparent",cursor:"pointer",display:"flex",flexDirection:"column",gap:6,flex:1},children:[(0,t.jsx)("div",{style:{fontWeight:"bold"},children:"Current"}),(0,t.jsx)("div",{style:{color:"#444",fontSize:12},children:new Date((null==(e=p.header)?void 0:e.ts)||(null==(c=p.header)?void 0:c.updated)||Date.now()).toLocaleString()}),(0,t.jsx)("div",{style:{color:"#666",fontSize:12},children:"Live (uncommitted)"})]})}),0===b.length&&(0,t.jsx)("div",{style:{color:"#666"},children:"No versions yet."}),b.map(e=>{var i,l,n;return(0,t.jsxs)("div",{style:{padding:8,borderRadius:6,background:w===e.label?"#eef":"transparent",cursor:"pointer",display:"flex",flexDirection:"column",gap:6},onClick:()=>{y(e.snapshot||p),C(e.label)},children:[(0,t.jsx)("div",{style:{fontWeight:"bold"},children:e.label}),(0,t.jsx)("div",{style:{color:"#444",fontSize:12},children:new Date((null==(i=e.meta)?void 0:i.ts)||0).toLocaleString()}),(0,t.jsx)("div",{style:{color:"#666",fontSize:12,textAlign:"left"},children:(null==(l=e.meta)?void 0:l.changelog)&&Object.keys(e.meta.changelog).length>0?Object.entries(e.meta.changelog).map(e=>{let[i,l]=e;return(0,t.jsxs)("div",{style:{marginBottom:6},children:[(0,t.jsx)("div",{style:{fontWeight:"600"},children:i}),Array.isArray(l)&&l.length>0?(0,t.jsx)("ul",{style:{margin:"4px 0 0 1em",padding:0},children:l.map((e,i)=>(0,t.jsx)("li",{style:{listStyle:"disc",marginLeft:"1em",fontSize:12},children:e},i))}):null]},i)}):(0,t.jsx)("div",{children:(null==(n=e.meta)?void 0:n.message)||""})})]},e.label)})]}),(0,t.jsx)("div",{style:{borderTop:"1px solid rgba(0,0,0,0.06)",paddingTop:8,marginTop:8,display:"flex",justifyContent:"flex-end",gap:8,alignItems:"center"},children:(0,t.jsx)("button",{onClick:()=>{L(!0)},style:{height:"5vh",alignItems:"center",justifyContent:"center",display:"flex",border:"none",borderRadius:6,cursor:"pointer",color:"white",fontWeight:"bold",backgroundColor:"var(--main)",padding:"6px",width:"100%"},children:T?"Downloading...":"Download"})})]})]}),T&&(0,t.jsx)(o.default,{a3:m,format:k,onFinish:()=>L(!1)})]}):(0,t.jsx)("div",{style:{padding:24},children:"Loading A3…"})}},70653,e=>{e.v(t=>Promise.all(["static/chunks/3b0e68bb28d244be.js"].map(t=>e.l(t))).then(()=>t(24154)))},48503,e=>{e.v(e=>Promise.resolve().then(()=>e(15833)))},95111,e=>{e.v(t=>Promise.all(["static/chunks/8dfbfd4130b1ce48.js"].map(t=>e.l(t))).then(()=>t(38201)))}]);